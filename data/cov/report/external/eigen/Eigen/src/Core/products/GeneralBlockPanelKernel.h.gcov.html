<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - stripped_conv.info - external/eigen/Eigen/src/Core/products/GeneralBlockPanelKernel.h</title>
  <link rel="stylesheet" type="text/css" href="../../../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../../../index.html">top level</a> - <a href="index.html">external/eigen/Eigen/src/Core/products</a> - GeneralBlockPanelKernel.h<span style="font-size: 80%;"> (source / <a href="GeneralBlockPanelKernel.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">stripped_conv.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">403</td>
            <td class="headerCovTableEntry">419</td>
            <td class="headerCovTableEntryHi">96.2 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2020-05-21 16:34:32</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">17</td>
            <td class="headerCovTableEntry">33</td>
            <td class="headerCovTableEntryLo">51.5 %</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">377</td>
            <td class="headerCovTableEntry">1194</td>
            <td class="headerCovTableEntryLo">31.6 %</td>
          </tr>
          <tr><td><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : // This file is part of Eigen, a lightweight C++ template library</a>
<span class="lineNum">       2 </span>                :            : // for linear algebra.
<span class="lineNum">       3 </span>                :            : //
<span class="lineNum">       4 </span>                :            : // Copyright (C) 2008-2009 Gael Guennebaud &lt;gael.guennebaud@inria.fr&gt;
<span class="lineNum">       5 </span>                :            : //
<span class="lineNum">       6 </span>                :            : // This Source Code Form is subject to the terms of the Mozilla
<span class="lineNum">       7 </span>                :            : // Public License v. 2.0. If a copy of the MPL was not distributed
<span class="lineNum">       8 </span>                :            : // with this file, You can obtain one at http://mozilla.org/MPL/2.0/.
<span class="lineNum">       9 </span>                :            : 
<span class="lineNum">      10 </span>                :            : #ifndef EIGEN_GENERAL_BLOCK_PANEL_H
<span class="lineNum">      11 </span>                :            : #define EIGEN_GENERAL_BLOCK_PANEL_H
<span class="lineNum">      12 </span>                :            : 
<span class="lineNum">      13 </span>                :            : namespace Eigen { 
<span class="lineNum">      14 </span>                :            :   
<span class="lineNum">      15 </span>                :            : namespace internal {
<span class="lineNum">      16 </span>                :            : 
<span class="lineNum">      17 </span>                :            : template&lt;typename _LhsScalar, typename _RhsScalar, bool _ConjLhs=false, bool _ConjRhs=false&gt;
<span class="lineNum">      18 </span>                :            : class gebp_traits;
<span class="lineNum">      19 </span>                :            : 
<a name="20"><span class="lineNum">      20 </span>                :            : </a>
<span class="lineNum">      21 </span>                :            : /** \internal \returns b if a&lt;=0, and returns a otherwise. */
<span class="lineNum">      22 </span>                :<span class="lineCov">          8 : inline std::ptrdiff_t manage_caching_sizes_helper(std::ptrdiff_t a, std::ptrdiff_t b)</span>
<span class="lineNum">      23 </span>                :            : {
<span class="lineNum">      24 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 8 times"> + </span>]:<span class="lineCov">          8 :   return a&lt;=0 ? b : a;</span>
<span class="lineNum">      25 </span>                :            : }
<a name="26"><span class="lineNum">      26 </span>                :            : </a>
<span class="lineNum">      27 </span>                :            : /** \internal */
<span class="lineNum">      28 </span>                :<span class="lineCov">       2217 : inline void manage_caching_sizes(Action action, std::ptrdiff_t* l1=0, std::ptrdiff_t* l2=0)</span>
<span class="lineNum">      29 </span>                :            : {
<span class="lineNum">      30 </span>                :            :   static std::ptrdiff_t m_l1CacheSize = 0;
<span class="lineNum">      31 </span>                :            :   static std::ptrdiff_t m_l2CacheSize = 0;
<span class="lineNum">      32 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 2213 times"> + </span>]:<span class="lineCov">       2217 :   if(m_l2CacheSize==0)</span>
<span class="lineNum">      33 </span>                :            :   {
<span class="lineNum">      34 </span>                :<span class="lineCov">          4 :     m_l1CacheSize = manage_caching_sizes_helper(queryL1CacheSize(),8 * 1024);</span>
<span class="lineNum">      35 </span>                :<span class="lineCov">          4 :     m_l2CacheSize = manage_caching_sizes_helper(queryTopLevelCacheSize(),1*1024*1024);</span>
<span class="lineNum">      36 </span>                :            :   }
<span class="lineNum">      37 </span>                :            :   
<span class="lineNum">      38 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 2217 times"> + </span>]:<span class="lineCov">       2217 :   if(action==SetAction)</span>
<span class="lineNum">      39 </span>                :            :   {
<span class="lineNum">      40 </span>                :            :     // set the cpu cache size and cache all block sizes from a global cache size in byte
<span class="lineNum">      41 </span>                :            :     eigen_internal_assert(l1!=0 &amp;&amp; l2!=0);
<span class="lineNum">      42 </span>                :<span class="lineNoCov">          0 :     m_l1CacheSize = *l1;</span>
<span class="lineNum">      43 </span>                :<span class="lineNoCov">          0 :     m_l2CacheSize = *l2;</span>
<span class="lineNum">      44 </span>                :            :   }
<span class="lineNum">      45 </span>        [<span class="branchCov" title="Branch 0 was taken 2217 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2217 :   else if(action==GetAction)</span>
<span class="lineNum">      46 </span>                :            :   {
<span class="lineNum">      47 </span>                :            :     eigen_internal_assert(l1!=0 &amp;&amp; l2!=0);
<span class="lineNum">      48 </span>                :<span class="lineCov">       2217 :     *l1 = m_l1CacheSize;</span>
<span class="lineNum">      49 </span>                :<span class="lineCov">       2217 :     *l2 = m_l2CacheSize;</span>
<span class="lineNum">      50 </span>                :            :   }
<span class="lineNum">      51 </span>                :            :   else
<span class="lineNum">      52 </span>                :            :   {
<span class="lineNum">      53 </span>                :            :     eigen_internal_assert(false);
<span class="lineNum">      54 </span>                :            :   }
<span class="lineNum">      55 </span>                :<span class="lineCov">       2217 : }</span>
<span class="lineNum">      56 </span>                :            : 
<span class="lineNum">      57 </span>                :            : /** \brief Computes the blocking parameters for a m x k times k x n matrix product
<span class="lineNum">      58 </span>                :            :   *
<span class="lineNum">      59 </span>                :            :   * \param[in,out] k Input: the third dimension of the product. Output: the blocking size along the same dimension.
<span class="lineNum">      60 </span>                :            :   * \param[in,out] m Input: the number of rows of the left hand side. Output: the blocking size along the same dimension.
<span class="lineNum">      61 </span>                :            :   * \param[in,out] n Input: the number of columns of the right hand side. Output: the blocking size along the same dimension.
<span class="lineNum">      62 </span>                :            :   *
<span class="lineNum">      63 </span>                :            :   * Given a m x k times k x n matrix product of scalar types \c LhsScalar and \c RhsScalar,
<span class="lineNum">      64 </span>                :            :   * this function computes the blocking size parameters along the respective dimensions
<span class="lineNum">      65 </span>                :            :   * for matrix products and related algorithms. The blocking sizes depends on various
<span class="lineNum">      66 </span>                :            :   * parameters:
<span class="lineNum">      67 </span>                :            :   * - the L1 and L2 cache sizes,
<span class="lineNum">      68 </span>                :            :   * - the register level blocking sizes defined by gebp_traits,
<span class="lineNum">      69 </span>                :            :   * - the number of scalars that fit into a packet (when vectorization is enabled).
<span class="lineNum">      70 </span>                :            :   *
<a name="71"><span class="lineNum">      71 </span>                :            :   * \sa setCpuCacheSizes */</a>
<span class="lineNum">      72 </span>                :            : template&lt;typename LhsScalar, typename RhsScalar, int KcFactor, typename SizeType&gt;
<span class="lineNum">      73 </span>                :<span class="lineCov">       1851 : void computeProductBlockingSizes(SizeType&amp; k, SizeType&amp; m, SizeType&amp; n)</span>
<span class="lineNum">      74 </span>                :            : {
<span class="lineNum">      75 </span>[<span class="branchCov" title="Branch 1 was taken 332 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1519 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1851 :   EIGEN_UNUSED_VARIABLE(n);</span>
<span class="lineNum">      76 </span>                :            :   // Explanations:
<span class="lineNum">      77 </span>                :            :   // Let's recall the product algorithms form kc x nc horizontal panels B' on the rhs and
<span class="lineNum">      78 </span>                :            :   // mc x kc blocks A' on the lhs. A' has to fit into L2 cache. Moreover, B' is processed
<span class="lineNum">      79 </span>                :            :   // per kc x nr vertical small panels where nr is the blocking size along the n dimension
<span class="lineNum">      80 </span>                :            :   // at the register level. For vectorization purpose, these small vertical panels are unpacked,
<span class="lineNum">      81 </span>                :            :   // e.g., each coefficient is replicated to fit a packet. This small vertical panel has to
<span class="lineNum">      82 </span>                :            :   // stay in L1 cache.
<span class="lineNum">      83 </span>                :            :   std::ptrdiff_t l1, l2;
<span class="lineNum">      84 </span>                :            : 
<span class="lineNum">      85 </span>                :            :   typedef gebp_traits&lt;LhsScalar,RhsScalar&gt; Traits;
<span class="lineNum">      86 </span>                :            :   enum {
<span class="lineNum">      87 </span>                :            :     kdiv = KcFactor * 2 * Traits::nr
<span class="lineNum">      88 </span>                :            :          * Traits::RhsProgress * sizeof(RhsScalar),
<span class="lineNum">      89 </span>                :            :     mr = gebp_traits&lt;LhsScalar,RhsScalar&gt;::mr,
<span class="lineNum">      90 </span>                :            :     mr_mask = (0xffffffff/mr)*mr
<span class="lineNum">      91 </span>                :            :   };
<span class="lineNum">      92 </span>                :            : 
<span class="lineNum">      93 </span>[<span class="branchCov" title="Branch 1 was taken 332 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1519 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1851 :   manage_caching_sizes(GetAction, &amp;l1, &amp;l2);</span>
<span class="lineNum">      94 </span>[<span class="branchCov" title="Branch 1 was taken 332 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1519 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1851 :   k = std::min&lt;SizeType&gt;(k, l1/kdiv);</span>
<span class="lineNum">      95 </span>[<span class="branchCov" title="Branch 0 was taken 332 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchCov" title="Branch 2 was taken 1519 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1851 :   SizeType _m = k&gt;0 ? l2/(4 * sizeof(LhsScalar) * k) : 0;</span>
<span class="lineNum">      96 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 332 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 1519 times"> + </span>]:<span class="lineCov">       1851 :   if(_m&lt;m) m = _m &amp; mr_mask;</span>
<span class="lineNum">      97 </span>                :<span class="lineCov">       1851 : }</span>
<a name="98"><span class="lineNum">      98 </span>                :            : </a>
<span class="lineNum">      99 </span>                :            : template&lt;typename LhsScalar, typename RhsScalar, typename SizeType&gt;
<span class="lineNum">     100 </span>                :<span class="lineNoCov">          0 : inline void computeProductBlockingSizes(SizeType&amp; k, SizeType&amp; m, SizeType&amp; n)</span>
<span class="lineNum">     101 </span>                :            : {
<span class="lineNum">     102 </span>                :<span class="lineNoCov">          0 :   computeProductBlockingSizes&lt;LhsScalar,RhsScalar,1&gt;(k, m, n);</span>
<span class="lineNum">     103 </span>                :<span class="lineNoCov">          0 : }</span>
<span class="lineNum">     104 </span>                :            : 
<span class="lineNum">     105 </span>                :            : #ifdef EIGEN_HAS_FUSE_CJMADD
<span class="lineNum">     106 </span>                :            :   #define MADD(CJ,A,B,C,T)  C = CJ.pmadd(A,B,C);
<span class="lineNum">     107 </span>                :            : #else
<span class="lineNum">     108 </span>                :            : 
<span class="lineNum">     109 </span>                :            :   // FIXME (a bit overkill maybe ?)
<span class="lineNum">     110 </span>                :            : 
<span class="lineNum">     111 </span>                :            :   template&lt;typename CJ, typename A, typename B, typename C, typename T&gt; struct gebp_madd_selector {
<span class="lineNum">     112 </span>                :            :     EIGEN_ALWAYS_INLINE static void run(const CJ&amp; cj, A&amp; a, B&amp; b, C&amp; c, T&amp; /*t*/)
<span class="lineNum">     113 </span>                :            :     {
<span class="lineNum">     114 </span>                :            :       c = cj.pmadd(a,b,c);
<span class="lineNum">     115 </span>                :            :     }
<span class="lineNum">     116 </span>                :            :   };
<span class="lineNum">     117 </span>                :            : 
<span class="lineNum">     118 </span>                :            :   template&lt;typename CJ, typename T&gt; struct gebp_madd_selector&lt;CJ,T,T,T,T&gt; {
<span class="lineNum">     119 </span>                :            :     EIGEN_ALWAYS_INLINE static void run(const CJ&amp; cj, T&amp; a, T&amp; b, T&amp; c, T&amp; t)
<span class="lineNum">     120 </span>                :            :     {
<span class="lineNum">     121 </span>                :<span class="lineCov">       7868 :       t = b; t = cj.pmul(a,t); c = padd(c,t);</span>
<span class="lineNum">     122 </span>                :            :     }
<span class="lineNum">     123 </span>                :            :   };
<a name="124"><span class="lineNum">     124 </span>                :            : </a>
<span class="lineNum">     125 </span>                :            :   template&lt;typename CJ, typename A, typename B, typename C, typename T&gt;
<span class="lineNum">     126 </span>                :<span class="lineCov">       7868 :   EIGEN_STRONG_INLINE void gebp_madd(const CJ&amp; cj, A&amp; a, B&amp; b, C&amp; c, T&amp; t)</span>
<span class="lineNum">     127 </span>                :            :   {
<span class="lineNum">     128 </span>                :            :     gebp_madd_selector&lt;CJ,A,B,C,T&gt;::run(cj,a,b,c,t);
<span class="lineNum">     129 </span>                :<span class="lineCov">       7868 :   }</span>
<span class="lineNum">     130 </span>                :            : 
<span class="lineNum">     131 </span>                :            :   #define MADD(CJ,A,B,C,T)  gebp_madd(CJ,A,B,C,T);
<span class="lineNum">     132 </span>                :            : //   #define MADD(CJ,A,B,C,T)  T = B; T = CJ.pmul(A,T); C = padd(C,T);
<span class="lineNum">     133 </span>                :            : #endif
<span class="lineNum">     134 </span>                :            : 
<span class="lineNum">     135 </span>                :            : /* Vectorization logic
<span class="lineNum">     136 </span>                :            :  *  real*real: unpack rhs to constant packets, ...
<span class="lineNum">     137 </span>                :            :  * 
<span class="lineNum">     138 </span>                :            :  *  cd*cd : unpack rhs to (b_r,b_r), (b_i,b_i), mul to get (a_r b_r,a_i b_r) (a_r b_i,a_i b_i),
<span class="lineNum">     139 </span>                :            :  *          storing each res packet into two packets (2x2),
<span class="lineNum">     140 </span>                :            :  *          at the end combine them: swap the second and addsub them 
<span class="lineNum">     141 </span>                :            :  *  cf*cf : same but with 2x4 blocks
<span class="lineNum">     142 </span>                :            :  *  cplx*real : unpack rhs to constant packets, ...
<span class="lineNum">     143 </span>                :            :  *  real*cplx : load lhs as (a0,a0,a1,a1), and mul as usual
<span class="lineNum">     144 </span>                :            :  */
<span class="lineNum">     145 </span>                :            : template&lt;typename _LhsScalar, typename _RhsScalar, bool _ConjLhs, bool _ConjRhs&gt;
<span class="lineNum">     146 </span>                :            : class gebp_traits
<span class="lineNum">     147 </span>                :            : {
<span class="lineNum">     148 </span>                :            : public:
<span class="lineNum">     149 </span>                :            :   typedef _LhsScalar LhsScalar;
<span class="lineNum">     150 </span>                :            :   typedef _RhsScalar RhsScalar;
<span class="lineNum">     151 </span>                :            :   typedef typename scalar_product_traits&lt;LhsScalar, RhsScalar&gt;::ReturnType ResScalar;
<span class="lineNum">     152 </span>                :            : 
<span class="lineNum">     153 </span>                :            :   enum {
<span class="lineNum">     154 </span>                :            :     ConjLhs = _ConjLhs,
<span class="lineNum">     155 </span>                :            :     ConjRhs = _ConjRhs,
<span class="lineNum">     156 </span>                :            :     Vectorizable = packet_traits&lt;LhsScalar&gt;::Vectorizable &amp;&amp; packet_traits&lt;RhsScalar&gt;::Vectorizable,
<span class="lineNum">     157 </span>                :            :     LhsPacketSize = Vectorizable ? packet_traits&lt;LhsScalar&gt;::size : 1,
<span class="lineNum">     158 </span>                :            :     RhsPacketSize = Vectorizable ? packet_traits&lt;RhsScalar&gt;::size : 1,
<span class="lineNum">     159 </span>                :            :     ResPacketSize = Vectorizable ? packet_traits&lt;ResScalar&gt;::size : 1,
<span class="lineNum">     160 </span>                :            :     
<span class="lineNum">     161 </span>                :            :     NumberOfRegisters = EIGEN_ARCH_DEFAULT_NUMBER_OF_REGISTERS,
<span class="lineNum">     162 </span>                :            : 
<span class="lineNum">     163 </span>                :            :     // register block size along the N direction (must be either 2 or 4)
<span class="lineNum">     164 </span>                :            :     nr = NumberOfRegisters/4,
<span class="lineNum">     165 </span>                :            : 
<span class="lineNum">     166 </span>                :            :     // register block size along the M direction (currently, this one cannot be modified)
<span class="lineNum">     167 </span>                :            :     mr = 2 * LhsPacketSize,
<span class="lineNum">     168 </span>                :            :     
<span class="lineNum">     169 </span>                :            :     WorkSpaceFactor = nr * RhsPacketSize,
<span class="lineNum">     170 </span>                :            : 
<span class="lineNum">     171 </span>                :            :     LhsProgress = LhsPacketSize,
<span class="lineNum">     172 </span>                :            :     RhsProgress = RhsPacketSize
<span class="lineNum">     173 </span>                :            :   };
<span class="lineNum">     174 </span>                :            : 
<span class="lineNum">     175 </span>                :            :   typedef typename packet_traits&lt;LhsScalar&gt;::type  _LhsPacket;
<span class="lineNum">     176 </span>                :            :   typedef typename packet_traits&lt;RhsScalar&gt;::type  _RhsPacket;
<span class="lineNum">     177 </span>                :            :   typedef typename packet_traits&lt;ResScalar&gt;::type  _ResPacket;
<span class="lineNum">     178 </span>                :            : 
<span class="lineNum">     179 </span>                :            :   typedef typename conditional&lt;Vectorizable,_LhsPacket,LhsScalar&gt;::type LhsPacket;
<span class="lineNum">     180 </span>                :            :   typedef typename conditional&lt;Vectorizable,_RhsPacket,RhsScalar&gt;::type RhsPacket;
<span class="lineNum">     181 </span>                :            :   typedef typename conditional&lt;Vectorizable,_ResPacket,ResScalar&gt;::type ResPacket;
<span class="lineNum">     182 </span>                :            : 
<a name="183"><span class="lineNum">     183 </span>                :            :   typedef ResPacket AccPacket;</a>
<span class="lineNum">     184 </span>                :            :   
<span class="lineNum">     185 </span>                :<span class="lineCov">       5627 :   EIGEN_STRONG_INLINE void initAcc(AccPacket&amp; p)</span>
<span class="lineNum">     186 </span>                :            :   {
<span class="lineNum">     187 </span>[<span class="branchCov" title="Branch 1 was taken 5627 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">       5627 :     p = pset1&lt;ResPacket&gt;(ResScalar(0));</span>
<a name="188"><span class="lineNum">     188 </span>                :<span class="lineCov">       5627 :   }</span></a>
<span class="lineNum">     189 </span>                :            : 
<span class="lineNum">     190 </span>                :<span class="lineCov">       1561 :   EIGEN_STRONG_INLINE void unpackRhs(DenseIndex n, const RhsScalar* rhs, RhsScalar* b)</span>
<span class="lineNum">     191 </span>                :            :   {
<span class="lineNum">     192 </span>[<span class="branchCov" title="Branch 0 was taken 16908 times"> + </span><span class="branchCov" title="Branch 1 was taken 1561 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">      18469 :     for(DenseIndex k=0; k&lt;n; k++)</span>
<span class="lineNum">     193 </span>                :<span class="lineCov">      16908 :       pstore1&lt;RhsPacket&gt;(&amp;b[k*RhsPacketSize], rhs[k]);</span>
<a name="194"><span class="lineNum">     194 </span>                :<span class="lineCov">       1561 :   }</span></a>
<span class="lineNum">     195 </span>                :            : 
<span class="lineNum">     196 </span>                :<span class="lineCov">       9238 :   EIGEN_STRONG_INLINE void loadRhs(const RhsScalar* b, RhsPacket&amp; dest) const</span>
<span class="lineNum">     197 </span>                :            :   {
<span class="lineNum">     198 </span>                :<span class="lineCov">       9238 :     dest = pload&lt;RhsPacket&gt;(b);</span>
<a name="199"><span class="lineNum">     199 </span>                :<span class="lineCov">       9238 :   }</span></a>
<span class="lineNum">     200 </span>                :            : 
<span class="lineNum">     201 </span>                :<span class="lineCov">       5858 :   EIGEN_STRONG_INLINE void loadLhs(const LhsScalar* a, LhsPacket&amp; dest) const</span>
<span class="lineNum">     202 </span>                :            :   {
<span class="lineNum">     203 </span>                :<span class="lineCov">       5858 :     dest = pload&lt;LhsPacket&gt;(a);</span>
<a name="204"><span class="lineNum">     204 </span>                :<span class="lineCov">       5858 :   }</span></a>
<span class="lineNum">     205 </span>                :            : 
<span class="lineNum">     206 </span>                :<span class="lineCov">      18086 :   EIGEN_STRONG_INLINE void madd(const LhsPacket&amp; a, const RhsPacket&amp; b, AccPacket&amp; c, AccPacket&amp; tmp) const</span>
<span class="lineNum">     207 </span>                :            :   {
<span class="lineNum">     208 </span>                :<span class="lineCov">      18086 :     tmp = b; tmp = pmul(a,tmp); c = padd(c,tmp);</span>
<a name="209"><span class="lineNum">     209 </span>                :<span class="lineCov">      18086 :   }</span></a>
<span class="lineNum">     210 </span>                :            : 
<span class="lineNum">     211 </span>                :<span class="lineCov">       5627 :   EIGEN_STRONG_INLINE void acc(const AccPacket&amp; c, const ResPacket&amp; alpha, ResPacket&amp; r) const</span>
<span class="lineNum">     212 </span>                :            :   {
<span class="lineNum">     213 </span>                :<span class="lineCov">       5627 :     r = pmadd(c,alpha,r);</span>
<span class="lineNum">     214 </span>                :<span class="lineCov">       5627 :   }</span>
<span class="lineNum">     215 </span>                :            : 
<span class="lineNum">     216 </span>                :            : protected:
<span class="lineNum">     217 </span>                :            : //   conj_helper&lt;LhsScalar,RhsScalar,ConjLhs,ConjRhs&gt; cj;
<span class="lineNum">     218 </span>                :            : //   conj_helper&lt;LhsPacket,RhsPacket,ConjLhs,ConjRhs&gt; pcj;
<span class="lineNum">     219 </span>                :            : };
<span class="lineNum">     220 </span>                :            : 
<span class="lineNum">     221 </span>                :            : template&lt;typename RealScalar, bool _ConjLhs&gt;
<span class="lineNum">     222 </span>                :            : class gebp_traits&lt;std::complex&lt;RealScalar&gt;, RealScalar, _ConjLhs, false&gt;
<span class="lineNum">     223 </span>                :            : {
<span class="lineNum">     224 </span>                :            : public:
<span class="lineNum">     225 </span>                :            :   typedef std::complex&lt;RealScalar&gt; LhsScalar;
<span class="lineNum">     226 </span>                :            :   typedef RealScalar RhsScalar;
<span class="lineNum">     227 </span>                :            :   typedef typename scalar_product_traits&lt;LhsScalar, RhsScalar&gt;::ReturnType ResScalar;
<span class="lineNum">     228 </span>                :            : 
<span class="lineNum">     229 </span>                :            :   enum {
<span class="lineNum">     230 </span>                :            :     ConjLhs = _ConjLhs,
<span class="lineNum">     231 </span>                :            :     ConjRhs = false,
<span class="lineNum">     232 </span>                :            :     Vectorizable = packet_traits&lt;LhsScalar&gt;::Vectorizable &amp;&amp; packet_traits&lt;RhsScalar&gt;::Vectorizable,
<span class="lineNum">     233 </span>                :            :     LhsPacketSize = Vectorizable ? packet_traits&lt;LhsScalar&gt;::size : 1,
<span class="lineNum">     234 </span>                :            :     RhsPacketSize = Vectorizable ? packet_traits&lt;RhsScalar&gt;::size : 1,
<span class="lineNum">     235 </span>                :            :     ResPacketSize = Vectorizable ? packet_traits&lt;ResScalar&gt;::size : 1,
<span class="lineNum">     236 </span>                :            :     
<span class="lineNum">     237 </span>                :            :     NumberOfRegisters = EIGEN_ARCH_DEFAULT_NUMBER_OF_REGISTERS,
<span class="lineNum">     238 </span>                :            :     nr = NumberOfRegisters/4,
<span class="lineNum">     239 </span>                :            :     mr = 2 * LhsPacketSize,
<span class="lineNum">     240 </span>                :            :     WorkSpaceFactor = nr*RhsPacketSize,
<span class="lineNum">     241 </span>                :            : 
<span class="lineNum">     242 </span>                :            :     LhsProgress = LhsPacketSize,
<span class="lineNum">     243 </span>                :            :     RhsProgress = RhsPacketSize
<span class="lineNum">     244 </span>                :            :   };
<span class="lineNum">     245 </span>                :            : 
<span class="lineNum">     246 </span>                :            :   typedef typename packet_traits&lt;LhsScalar&gt;::type  _LhsPacket;
<span class="lineNum">     247 </span>                :            :   typedef typename packet_traits&lt;RhsScalar&gt;::type  _RhsPacket;
<span class="lineNum">     248 </span>                :            :   typedef typename packet_traits&lt;ResScalar&gt;::type  _ResPacket;
<span class="lineNum">     249 </span>                :            : 
<span class="lineNum">     250 </span>                :            :   typedef typename conditional&lt;Vectorizable,_LhsPacket,LhsScalar&gt;::type LhsPacket;
<span class="lineNum">     251 </span>                :            :   typedef typename conditional&lt;Vectorizable,_RhsPacket,RhsScalar&gt;::type RhsPacket;
<span class="lineNum">     252 </span>                :            :   typedef typename conditional&lt;Vectorizable,_ResPacket,ResScalar&gt;::type ResPacket;
<span class="lineNum">     253 </span>                :            : 
<span class="lineNum">     254 </span>                :            :   typedef ResPacket AccPacket;
<span class="lineNum">     255 </span>                :            : 
<span class="lineNum">     256 </span>                :            :   EIGEN_STRONG_INLINE void initAcc(AccPacket&amp; p)
<span class="lineNum">     257 </span>                :            :   {
<span class="lineNum">     258 </span>                :            :     p = pset1&lt;ResPacket&gt;(ResScalar(0));
<span class="lineNum">     259 </span>                :            :   }
<span class="lineNum">     260 </span>                :            : 
<span class="lineNum">     261 </span>                :            :   EIGEN_STRONG_INLINE void unpackRhs(DenseIndex n, const RhsScalar* rhs, RhsScalar* b)
<span class="lineNum">     262 </span>                :            :   {
<span class="lineNum">     263 </span>                :            :     for(DenseIndex k=0; k&lt;n; k++)
<span class="lineNum">     264 </span>                :            :       pstore1&lt;RhsPacket&gt;(&amp;b[k*RhsPacketSize], rhs[k]);
<span class="lineNum">     265 </span>                :            :   }
<span class="lineNum">     266 </span>                :            : 
<span class="lineNum">     267 </span>                :            :   EIGEN_STRONG_INLINE void loadRhs(const RhsScalar* b, RhsPacket&amp; dest) const
<span class="lineNum">     268 </span>                :            :   {
<span class="lineNum">     269 </span>                :            :     dest = pload&lt;RhsPacket&gt;(b);
<span class="lineNum">     270 </span>                :            :   }
<span class="lineNum">     271 </span>                :            : 
<span class="lineNum">     272 </span>                :            :   EIGEN_STRONG_INLINE void loadLhs(const LhsScalar* a, LhsPacket&amp; dest) const
<span class="lineNum">     273 </span>                :            :   {
<span class="lineNum">     274 </span>                :            :     dest = pload&lt;LhsPacket&gt;(a);
<span class="lineNum">     275 </span>                :            :   }
<span class="lineNum">     276 </span>                :            : 
<span class="lineNum">     277 </span>                :            :   EIGEN_STRONG_INLINE void madd(const LhsPacket&amp; a, const RhsPacket&amp; b, AccPacket&amp; c, RhsPacket&amp; tmp) const
<span class="lineNum">     278 </span>                :            :   {
<span class="lineNum">     279 </span>                :            :     madd_impl(a, b, c, tmp, typename conditional&lt;Vectorizable,true_type,false_type&gt;::type());
<span class="lineNum">     280 </span>                :            :   }
<span class="lineNum">     281 </span>                :            : 
<span class="lineNum">     282 </span>                :            :   EIGEN_STRONG_INLINE void madd_impl(const LhsPacket&amp; a, const RhsPacket&amp; b, AccPacket&amp; c, RhsPacket&amp; tmp, const true_type&amp;) const
<span class="lineNum">     283 </span>                :            :   {
<span class="lineNum">     284 </span>                :            :     tmp = b; tmp = pmul(a.v,tmp); c.v = padd(c.v,tmp);
<span class="lineNum">     285 </span>                :            :   }
<span class="lineNum">     286 </span>                :            : 
<span class="lineNum">     287 </span>                :            :   EIGEN_STRONG_INLINE void madd_impl(const LhsScalar&amp; a, const RhsScalar&amp; b, ResScalar&amp; c, RhsScalar&amp; /*tmp*/, const false_type&amp;) const
<span class="lineNum">     288 </span>                :            :   {
<span class="lineNum">     289 </span>                :            :     c += a * b;
<span class="lineNum">     290 </span>                :            :   }
<span class="lineNum">     291 </span>                :            : 
<span class="lineNum">     292 </span>                :            :   EIGEN_STRONG_INLINE void acc(const AccPacket&amp; c, const ResPacket&amp; alpha, ResPacket&amp; r) const
<span class="lineNum">     293 </span>                :            :   {
<span class="lineNum">     294 </span>                :            :     r = cj.pmadd(c,alpha,r);
<span class="lineNum">     295 </span>                :            :   }
<span class="lineNum">     296 </span>                :            : 
<span class="lineNum">     297 </span>                :            : protected:
<span class="lineNum">     298 </span>                :            :   conj_helper&lt;ResPacket,ResPacket,ConjLhs,false&gt; cj;
<span class="lineNum">     299 </span>                :            : };
<span class="lineNum">     300 </span>                :            : 
<span class="lineNum">     301 </span>                :            : template&lt;typename RealScalar, bool _ConjLhs, bool _ConjRhs&gt;
<span class="lineNum">     302 </span>                :            : class gebp_traits&lt;std::complex&lt;RealScalar&gt;, std::complex&lt;RealScalar&gt;, _ConjLhs, _ConjRhs &gt;
<span class="lineNum">     303 </span>                :            : {
<span class="lineNum">     304 </span>                :            : public:
<span class="lineNum">     305 </span>                :            :   typedef std::complex&lt;RealScalar&gt;  Scalar;
<span class="lineNum">     306 </span>                :            :   typedef std::complex&lt;RealScalar&gt;  LhsScalar;
<span class="lineNum">     307 </span>                :            :   typedef std::complex&lt;RealScalar&gt;  RhsScalar;
<span class="lineNum">     308 </span>                :            :   typedef std::complex&lt;RealScalar&gt;  ResScalar;
<span class="lineNum">     309 </span>                :            :   
<span class="lineNum">     310 </span>                :            :   enum {
<span class="lineNum">     311 </span>                :            :     ConjLhs = _ConjLhs,
<span class="lineNum">     312 </span>                :            :     ConjRhs = _ConjRhs,
<span class="lineNum">     313 </span>                :            :     Vectorizable = packet_traits&lt;RealScalar&gt;::Vectorizable
<span class="lineNum">     314 </span>                :            :                 &amp;&amp; packet_traits&lt;Scalar&gt;::Vectorizable,
<span class="lineNum">     315 </span>                :            :     RealPacketSize  = Vectorizable ? packet_traits&lt;RealScalar&gt;::size : 1,
<span class="lineNum">     316 </span>                :            :     ResPacketSize   = Vectorizable ? packet_traits&lt;ResScalar&gt;::size : 1,
<span class="lineNum">     317 </span>                :            :     
<span class="lineNum">     318 </span>                :            :     nr = 2,
<span class="lineNum">     319 </span>                :            :     mr = 2 * ResPacketSize,
<span class="lineNum">     320 </span>                :            :     WorkSpaceFactor = Vectorizable ? 2*nr*RealPacketSize : nr,
<span class="lineNum">     321 </span>                :            : 
<span class="lineNum">     322 </span>                :            :     LhsProgress = ResPacketSize,
<span class="lineNum">     323 </span>                :            :     RhsProgress = Vectorizable ? 2*ResPacketSize : 1
<span class="lineNum">     324 </span>                :            :   };
<span class="lineNum">     325 </span>                :            :   
<span class="lineNum">     326 </span>                :            :   typedef typename packet_traits&lt;RealScalar&gt;::type RealPacket;
<span class="lineNum">     327 </span>                :            :   typedef typename packet_traits&lt;Scalar&gt;::type     ScalarPacket;
<span class="lineNum">     328 </span>                :            :   struct DoublePacket
<span class="lineNum">     329 </span>                :            :   {
<span class="lineNum">     330 </span>                :            :     RealPacket first;
<span class="lineNum">     331 </span>                :            :     RealPacket second;
<span class="lineNum">     332 </span>                :            :   };
<span class="lineNum">     333 </span>                :            : 
<span class="lineNum">     334 </span>                :            :   typedef typename conditional&lt;Vectorizable,RealPacket,  Scalar&gt;::type LhsPacket;
<span class="lineNum">     335 </span>                :            :   typedef typename conditional&lt;Vectorizable,DoublePacket,Scalar&gt;::type RhsPacket;
<span class="lineNum">     336 </span>                :            :   typedef typename conditional&lt;Vectorizable,ScalarPacket,Scalar&gt;::type ResPacket;
<span class="lineNum">     337 </span>                :            :   typedef typename conditional&lt;Vectorizable,DoublePacket,Scalar&gt;::type AccPacket;
<span class="lineNum">     338 </span>                :            :   
<span class="lineNum">     339 </span>                :            :   EIGEN_STRONG_INLINE void initAcc(Scalar&amp; p) { p = Scalar(0); }
<span class="lineNum">     340 </span>                :            : 
<span class="lineNum">     341 </span>                :            :   EIGEN_STRONG_INLINE void initAcc(DoublePacket&amp; p)
<span class="lineNum">     342 </span>                :            :   {
<span class="lineNum">     343 </span>                :            :     p.first   = pset1&lt;RealPacket&gt;(RealScalar(0));
<span class="lineNum">     344 </span>                :            :     p.second  = pset1&lt;RealPacket&gt;(RealScalar(0));
<span class="lineNum">     345 </span>                :            :   }
<span class="lineNum">     346 </span>                :            : 
<span class="lineNum">     347 </span>                :            :   /* Unpack the rhs coeff such that each complex coefficient is spread into
<span class="lineNum">     348 </span>                :            :    * two packects containing respectively the real and imaginary coefficient
<span class="lineNum">     349 </span>                :            :    * duplicated as many time as needed: (x+iy) =&gt; [x, ..., x] [y, ..., y]
<span class="lineNum">     350 </span>                :            :    */
<span class="lineNum">     351 </span>                :            :   EIGEN_STRONG_INLINE void unpackRhs(DenseIndex n, const Scalar* rhs, Scalar* b)
<span class="lineNum">     352 </span>                :            :   {
<span class="lineNum">     353 </span>                :            :     for(DenseIndex k=0; k&lt;n; k++)
<span class="lineNum">     354 </span>                :            :     {
<span class="lineNum">     355 </span>                :            :       if(Vectorizable)
<span class="lineNum">     356 </span>                :            :       {
<span class="lineNum">     357 </span>                :            :         pstore1&lt;RealPacket&gt;((RealScalar*)&amp;b[k*ResPacketSize*2+0],             real(rhs[k]));
<span class="lineNum">     358 </span>                :            :         pstore1&lt;RealPacket&gt;((RealScalar*)&amp;b[k*ResPacketSize*2+ResPacketSize], imag(rhs[k]));
<span class="lineNum">     359 </span>                :            :       }
<span class="lineNum">     360 </span>                :            :       else
<span class="lineNum">     361 </span>                :            :         b[k] = rhs[k];
<span class="lineNum">     362 </span>                :            :     }
<span class="lineNum">     363 </span>                :            :   }
<span class="lineNum">     364 </span>                :            : 
<span class="lineNum">     365 </span>                :            :   EIGEN_STRONG_INLINE void loadRhs(const RhsScalar* b, ResPacket&amp; dest) const { dest = *b; }
<span class="lineNum">     366 </span>                :            : 
<span class="lineNum">     367 </span>                :            :   EIGEN_STRONG_INLINE void loadRhs(const RhsScalar* b, DoublePacket&amp; dest) const
<span class="lineNum">     368 </span>                :            :   {
<span class="lineNum">     369 </span>                :            :     dest.first  = pload&lt;RealPacket&gt;((const RealScalar*)b);
<span class="lineNum">     370 </span>                :            :     dest.second = pload&lt;RealPacket&gt;((const RealScalar*)(b+ResPacketSize));
<span class="lineNum">     371 </span>                :            :   }
<span class="lineNum">     372 </span>                :            : 
<span class="lineNum">     373 </span>                :            :   // nothing special here
<span class="lineNum">     374 </span>                :            :   EIGEN_STRONG_INLINE void loadLhs(const LhsScalar* a, LhsPacket&amp; dest) const
<span class="lineNum">     375 </span>                :            :   {
<span class="lineNum">     376 </span>                :            :     dest = pload&lt;LhsPacket&gt;((const typename unpacket_traits&lt;LhsPacket&gt;::type*)(a));
<span class="lineNum">     377 </span>                :            :   }
<span class="lineNum">     378 </span>                :            : 
<span class="lineNum">     379 </span>                :            :   EIGEN_STRONG_INLINE void madd(const LhsPacket&amp; a, const RhsPacket&amp; b, DoublePacket&amp; c, RhsPacket&amp; /*tmp*/) const
<span class="lineNum">     380 </span>                :            :   {
<span class="lineNum">     381 </span>                :            :     c.first   = padd(pmul(a,b.first), c.first);
<span class="lineNum">     382 </span>                :            :     c.second  = padd(pmul(a,b.second),c.second);
<span class="lineNum">     383 </span>                :            :   }
<span class="lineNum">     384 </span>                :            : 
<span class="lineNum">     385 </span>                :            :   EIGEN_STRONG_INLINE void madd(const LhsPacket&amp; a, const RhsPacket&amp; b, ResPacket&amp; c, RhsPacket&amp; /*tmp*/) const
<span class="lineNum">     386 </span>                :            :   {
<span class="lineNum">     387 </span>                :            :     c = cj.pmadd(a,b,c);
<span class="lineNum">     388 </span>                :            :   }
<span class="lineNum">     389 </span>                :            :   
<span class="lineNum">     390 </span>                :            :   EIGEN_STRONG_INLINE void acc(const Scalar&amp; c, const Scalar&amp; alpha, Scalar&amp; r) const { r += alpha * c; }
<span class="lineNum">     391 </span>                :            :   
<span class="lineNum">     392 </span>                :            :   EIGEN_STRONG_INLINE void acc(const DoublePacket&amp; c, const ResPacket&amp; alpha, ResPacket&amp; r) const
<span class="lineNum">     393 </span>                :            :   {
<span class="lineNum">     394 </span>                :            :     // assemble c
<span class="lineNum">     395 </span>                :            :     ResPacket tmp;
<span class="lineNum">     396 </span>                :            :     if((!ConjLhs)&amp;&amp;(!ConjRhs))
<span class="lineNum">     397 </span>                :            :     {
<span class="lineNum">     398 </span>                :            :       tmp = pcplxflip(pconj(ResPacket(c.second)));
<span class="lineNum">     399 </span>                :            :       tmp = padd(ResPacket(c.first),tmp);
<span class="lineNum">     400 </span>                :            :     }
<span class="lineNum">     401 </span>                :            :     else if((!ConjLhs)&amp;&amp;(ConjRhs))
<span class="lineNum">     402 </span>                :            :     {
<span class="lineNum">     403 </span>                :            :       tmp = pconj(pcplxflip(ResPacket(c.second)));
<span class="lineNum">     404 </span>                :            :       tmp = padd(ResPacket(c.first),tmp);
<span class="lineNum">     405 </span>                :            :     }
<span class="lineNum">     406 </span>                :            :     else if((ConjLhs)&amp;&amp;(!ConjRhs))
<span class="lineNum">     407 </span>                :            :     {
<span class="lineNum">     408 </span>                :            :       tmp = pcplxflip(ResPacket(c.second));
<span class="lineNum">     409 </span>                :            :       tmp = padd(pconj(ResPacket(c.first)),tmp);
<span class="lineNum">     410 </span>                :            :     }
<span class="lineNum">     411 </span>                :            :     else if((ConjLhs)&amp;&amp;(ConjRhs))
<span class="lineNum">     412 </span>                :            :     {
<span class="lineNum">     413 </span>                :            :       tmp = pcplxflip(ResPacket(c.second));
<span class="lineNum">     414 </span>                :            :       tmp = psub(pconj(ResPacket(c.first)),tmp);
<span class="lineNum">     415 </span>                :            :     }
<span class="lineNum">     416 </span>                :            :     
<span class="lineNum">     417 </span>                :            :     r = pmadd(tmp,alpha,r);
<span class="lineNum">     418 </span>                :            :   }
<span class="lineNum">     419 </span>                :            : 
<span class="lineNum">     420 </span>                :            : protected:
<span class="lineNum">     421 </span>                :            :   conj_helper&lt;LhsScalar,RhsScalar,ConjLhs,ConjRhs&gt; cj;
<span class="lineNum">     422 </span>                :            : };
<span class="lineNum">     423 </span>                :            : 
<span class="lineNum">     424 </span>                :            : template&lt;typename RealScalar, bool _ConjRhs&gt;
<span class="lineNum">     425 </span>                :            : class gebp_traits&lt;RealScalar, std::complex&lt;RealScalar&gt;, false, _ConjRhs &gt;
<span class="lineNum">     426 </span>                :            : {
<span class="lineNum">     427 </span>                :            : public:
<span class="lineNum">     428 </span>                :            :   typedef std::complex&lt;RealScalar&gt;  Scalar;
<span class="lineNum">     429 </span>                :            :   typedef RealScalar  LhsScalar;
<span class="lineNum">     430 </span>                :            :   typedef Scalar      RhsScalar;
<span class="lineNum">     431 </span>                :            :   typedef Scalar      ResScalar;
<span class="lineNum">     432 </span>                :            : 
<span class="lineNum">     433 </span>                :            :   enum {
<span class="lineNum">     434 </span>                :            :     ConjLhs = false,
<span class="lineNum">     435 </span>                :            :     ConjRhs = _ConjRhs,
<span class="lineNum">     436 </span>                :            :     Vectorizable = packet_traits&lt;RealScalar&gt;::Vectorizable
<span class="lineNum">     437 </span>                :            :                 &amp;&amp; packet_traits&lt;Scalar&gt;::Vectorizable,
<span class="lineNum">     438 </span>                :            :     LhsPacketSize = Vectorizable ? packet_traits&lt;LhsScalar&gt;::size : 1,
<span class="lineNum">     439 </span>                :            :     RhsPacketSize = Vectorizable ? packet_traits&lt;RhsScalar&gt;::size : 1,
<span class="lineNum">     440 </span>                :            :     ResPacketSize = Vectorizable ? packet_traits&lt;ResScalar&gt;::size : 1,
<span class="lineNum">     441 </span>                :            :     
<span class="lineNum">     442 </span>                :            :     NumberOfRegisters = EIGEN_ARCH_DEFAULT_NUMBER_OF_REGISTERS,
<span class="lineNum">     443 </span>                :            :     nr = 4,
<span class="lineNum">     444 </span>                :            :     mr = 2*ResPacketSize,
<span class="lineNum">     445 </span>                :            :     WorkSpaceFactor = nr*RhsPacketSize,
<span class="lineNum">     446 </span>                :            : 
<span class="lineNum">     447 </span>                :            :     LhsProgress = ResPacketSize,
<span class="lineNum">     448 </span>                :            :     RhsProgress = ResPacketSize
<span class="lineNum">     449 </span>                :            :   };
<span class="lineNum">     450 </span>                :            : 
<span class="lineNum">     451 </span>                :            :   typedef typename packet_traits&lt;LhsScalar&gt;::type  _LhsPacket;
<span class="lineNum">     452 </span>                :            :   typedef typename packet_traits&lt;RhsScalar&gt;::type  _RhsPacket;
<span class="lineNum">     453 </span>                :            :   typedef typename packet_traits&lt;ResScalar&gt;::type  _ResPacket;
<span class="lineNum">     454 </span>                :            : 
<span class="lineNum">     455 </span>                :            :   typedef typename conditional&lt;Vectorizable,_LhsPacket,LhsScalar&gt;::type LhsPacket;
<span class="lineNum">     456 </span>                :            :   typedef typename conditional&lt;Vectorizable,_RhsPacket,RhsScalar&gt;::type RhsPacket;
<span class="lineNum">     457 </span>                :            :   typedef typename conditional&lt;Vectorizable,_ResPacket,ResScalar&gt;::type ResPacket;
<span class="lineNum">     458 </span>                :            : 
<span class="lineNum">     459 </span>                :            :   typedef ResPacket AccPacket;
<span class="lineNum">     460 </span>                :            : 
<span class="lineNum">     461 </span>                :            :   EIGEN_STRONG_INLINE void initAcc(AccPacket&amp; p)
<span class="lineNum">     462 </span>                :            :   {
<span class="lineNum">     463 </span>                :            :     p = pset1&lt;ResPacket&gt;(ResScalar(0));
<span class="lineNum">     464 </span>                :            :   }
<span class="lineNum">     465 </span>                :            : 
<span class="lineNum">     466 </span>                :            :   EIGEN_STRONG_INLINE void unpackRhs(DenseIndex n, const RhsScalar* rhs, RhsScalar* b)
<span class="lineNum">     467 </span>                :            :   {
<span class="lineNum">     468 </span>                :            :     for(DenseIndex k=0; k&lt;n; k++)
<span class="lineNum">     469 </span>                :            :       pstore1&lt;RhsPacket&gt;(&amp;b[k*RhsPacketSize], rhs[k]);
<span class="lineNum">     470 </span>                :            :   }
<span class="lineNum">     471 </span>                :            : 
<span class="lineNum">     472 </span>                :            :   EIGEN_STRONG_INLINE void loadRhs(const RhsScalar* b, RhsPacket&amp; dest) const
<span class="lineNum">     473 </span>                :            :   {
<span class="lineNum">     474 </span>                :            :     dest = pload&lt;RhsPacket&gt;(b);
<span class="lineNum">     475 </span>                :            :   }
<span class="lineNum">     476 </span>                :            : 
<span class="lineNum">     477 </span>                :            :   EIGEN_STRONG_INLINE void loadLhs(const LhsScalar* a, LhsPacket&amp; dest) const
<span class="lineNum">     478 </span>                :            :   {
<span class="lineNum">     479 </span>                :            :     dest = ploaddup&lt;LhsPacket&gt;(a);
<span class="lineNum">     480 </span>                :            :   }
<span class="lineNum">     481 </span>                :            : 
<span class="lineNum">     482 </span>                :            :   EIGEN_STRONG_INLINE void madd(const LhsPacket&amp; a, const RhsPacket&amp; b, AccPacket&amp; c, RhsPacket&amp; tmp) const
<span class="lineNum">     483 </span>                :            :   {
<span class="lineNum">     484 </span>                :            :     madd_impl(a, b, c, tmp, typename conditional&lt;Vectorizable,true_type,false_type&gt;::type());
<span class="lineNum">     485 </span>                :            :   }
<span class="lineNum">     486 </span>                :            : 
<span class="lineNum">     487 </span>                :            :   EIGEN_STRONG_INLINE void madd_impl(const LhsPacket&amp; a, const RhsPacket&amp; b, AccPacket&amp; c, RhsPacket&amp; tmp, const true_type&amp;) const
<span class="lineNum">     488 </span>                :            :   {
<span class="lineNum">     489 </span>                :            :     tmp = b; tmp.v = pmul(a,tmp.v); c = padd(c,tmp);
<span class="lineNum">     490 </span>                :            :   }
<span class="lineNum">     491 </span>                :            : 
<span class="lineNum">     492 </span>                :            :   EIGEN_STRONG_INLINE void madd_impl(const LhsScalar&amp; a, const RhsScalar&amp; b, ResScalar&amp; c, RhsScalar&amp; /*tmp*/, const false_type&amp;) const
<span class="lineNum">     493 </span>                :            :   {
<span class="lineNum">     494 </span>                :            :     c += a * b;
<span class="lineNum">     495 </span>                :            :   }
<span class="lineNum">     496 </span>                :            : 
<span class="lineNum">     497 </span>                :            :   EIGEN_STRONG_INLINE void acc(const AccPacket&amp; c, const ResPacket&amp; alpha, ResPacket&amp; r) const
<span class="lineNum">     498 </span>                :            :   {
<span class="lineNum">     499 </span>                :            :     r = cj.pmadd(alpha,c,r);
<span class="lineNum">     500 </span>                :            :   }
<span class="lineNum">     501 </span>                :            : 
<span class="lineNum">     502 </span>                :            : protected:
<span class="lineNum">     503 </span>                :            :   conj_helper&lt;ResPacket,ResPacket,false,ConjRhs&gt; cj;
<span class="lineNum">     504 </span>                :            : };
<span class="lineNum">     505 </span>                :            : 
<span class="lineNum">     506 </span>                :            : /* optimized GEneral packed Block * packed Panel product kernel
<span class="lineNum">     507 </span>                :            :  *
<span class="lineNum">     508 </span>                :            :  * Mixing type logic: C += A * B
<span class="lineNum">     509 </span>                :            :  *  |  A  |  B  | comments
<span class="lineNum">     510 </span>                :            :  *  |real |cplx | no vectorization yet, would require to pack A with duplication
<span class="lineNum">     511 </span>                :            :  *  |cplx |real | easy vectorization
<span class="lineNum">     512 </span>                :            :  */
<span class="lineNum">     513 </span>                :            : template&lt;typename LhsScalar, typename RhsScalar, typename Index, int mr, int nr, bool ConjugateLhs, bool ConjugateRhs&gt;
<span class="lineNum">     514 </span>                :            : struct gebp_kernel
<span class="lineNum">     515 </span>                :            : {
<span class="lineNum">     516 </span>                :            :   typedef gebp_traits&lt;LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs&gt; Traits;
<span class="lineNum">     517 </span>                :            :   typedef typename Traits::ResScalar ResScalar;
<span class="lineNum">     518 </span>                :            :   typedef typename Traits::LhsPacket LhsPacket;
<span class="lineNum">     519 </span>                :            :   typedef typename Traits::RhsPacket RhsPacket;
<span class="lineNum">     520 </span>                :            :   typedef typename Traits::ResPacket ResPacket;
<span class="lineNum">     521 </span>                :            :   typedef typename Traits::AccPacket AccPacket;
<span class="lineNum">     522 </span>                :            : 
<span class="lineNum">     523 </span>                :            :   enum {
<span class="lineNum">     524 </span>                :            :     Vectorizable  = Traits::Vectorizable,
<span class="lineNum">     525 </span>                :            :     LhsProgress   = Traits::LhsProgress,
<span class="lineNum">     526 </span>                :            :     RhsProgress   = Traits::RhsProgress,
<span class="lineNum">     527 </span>                :            :     ResPacketSize = Traits::ResPacketSize
<span class="lineNum">     528 </span>                :            :   };
<span class="lineNum">     529 </span>                :            : 
<span class="lineNum">     530 </span>                :            :   EIGEN_DONT_INLINE
<span class="lineNum">     531 </span>                :            :   void operator()(ResScalar* res, Index resStride, const LhsScalar* blockA, const RhsScalar* blockB, Index rows, Index depth, Index cols, ResScalar alpha,
<span class="lineNum">     532 </span>                :            :                   Index strideA=-1, Index strideB=-1, Index offsetA=0, Index offsetB=0, RhsScalar* unpackedB=0);
<span class="lineNum">     533 </span>                :            : };
<span class="lineNum">     534 </span>                :            : 
<a name="535"><span class="lineNum">     535 </span>                :            : template&lt;typename LhsScalar, typename RhsScalar, typename Index, int mr, int nr, bool ConjugateLhs, bool ConjugateRhs&gt;</a>
<span class="lineNum">     536 </span>                :            : EIGEN_DONT_INLINE
<span class="lineNum">     537 </span>                :<span class="lineCov">       1531 : void gebp_kernel&lt;LhsScalar,RhsScalar,Index,mr,nr,ConjugateLhs,ConjugateRhs&gt;</span>
<span class="lineNum">     538 </span>                :            :   ::operator()(ResScalar* res, Index resStride, const LhsScalar* blockA, const RhsScalar* blockB, Index rows, Index depth, Index cols, ResScalar alpha,
<span class="lineNum">     539 </span>                :            :                Index strideA, Index strideB, Index offsetA, Index offsetB, RhsScalar* unpackedB)
<span class="lineNum">     540 </span>                :            :   {
<span class="lineNum">     541 </span>                :            :     Traits traits;
<span class="lineNum">     542 </span>                :            :     
<span class="lineNum">     543 </span>[<span class="branchCov" title="Branch 0 was taken 1521 times"> + </span><span class="branchCov" title="Branch 1 was taken 10 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       1531 :     if(strideA==-1) strideA = depth;</span>
<span class="lineNum">     544 </span>[<span class="branchCov" title="Branch 0 was taken 1521 times"> + </span><span class="branchCov" title="Branch 1 was taken 10 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       1531 :     if(strideB==-1) strideB = depth;</span>
<span class="lineNum">     545 </span>                :            :     conj_helper&lt;LhsScalar,RhsScalar,ConjugateLhs,ConjugateRhs&gt; cj;
<span class="lineNum">     546 </span>                :            : //     conj_helper&lt;LhsPacket,RhsPacket,ConjugateLhs,ConjugateRhs&gt; pcj;
<span class="lineNum">     547 </span>                :<span class="lineCov">       1531 :     Index packet_cols = (cols/nr) * nr;</span>
<span class="lineNum">     548 </span>                :<span class="lineCov">       1531 :     const Index peeled_mc = (rows/mr)*mr;</span>
<span class="lineNum">     549 </span>                :            :     // FIXME:
<span class="lineNum">     550 </span>[<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchCov" title="Branch 1 was taken 1515 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       1531 :     const Index peeled_mc2 = peeled_mc + (rows-peeled_mc &gt;= LhsProgress ? LhsProgress : 0);</span>
<span class="lineNum">     551 </span>                :<span class="lineCov">       1531 :     const Index peeled_kc = (depth/4)*4;</span>
<span class="lineNum">     552 </span>                :            : 
<span class="lineNum">     553 </span>[<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1531 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       1531 :     if(unpackedB==0)</span>
<span class="lineNum">     554 </span>                :<span class="lineNoCov">          0 :       unpackedB = const_cast&lt;RhsScalar*&gt;(blockB - strideB * nr * RhsProgress);</span>
<span class="lineNum">     555 </span>                :            : 
<span class="lineNum">     556 </span>                :            :     // loops on each micro vertical panel of rhs (depth x nr)
<span class="lineNum">     557 </span>[<span class="branchCov" title="Branch 0 was taken 1075 times"> + </span><span class="branchCov" title="Branch 1 was taken 1531 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       2606 :     for(Index j2=0; j2&lt;packet_cols; j2+=nr)</span>
<span class="lineNum">     558 </span>                :            :     {
<span class="lineNum">     559 </span>[<span class="branchCov" title="Branch 1 was taken 1075 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">       1075 :       traits.unpackRhs(depth*nr,&amp;blockB[j2*strideB+offsetB*nr],unpackedB); </span>
<span class="lineNum">     560 </span>                :            : 
<span class="lineNum">     561 </span>                :            :       // loops on each largest micro horizontal panel of lhs (mr x depth)
<span class="lineNum">     562 </span>                :            :       // =&gt; we select a mr x nr micro block of res which is entirely
<span class="lineNum">     563 </span>                :            :       //    stored into mr/packet_size x nr registers.
<span class="lineNum">     564 </span>[<span class="branchCov" title="Branch 0 was taken 613 times"> + </span><span class="branchCov" title="Branch 1 was taken 1075 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       1688 :       for(Index i=0; i&lt;peeled_mc; i+=mr)</span>
<span class="lineNum">     565 </span>                :            :       {
<span class="lineNum">     566 </span>                :<span class="lineCov">        613 :         const LhsScalar* blA = &amp;blockA[i*strideA+offsetA*mr];</span>
<span class="lineNum">     567 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :         prefetch(&amp;blA[0]);</span>
<span class="lineNum">     568 </span>                :            : 
<span class="lineNum">     569 </span>                :            :         // gets res block as register
<span class="lineNum">     570 </span>                :            :         AccPacket C0, C1, C2, C3, C4, C5, C6, C7;
<span class="lineNum">     571 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :                   traits.initAcc(C0);</span>
<span class="lineNum">     572 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :                   traits.initAcc(C1);</span>
<span class="lineNum">     573 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :         if(nr==4) traits.initAcc(C2);</span>
<span class="lineNum">     574 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :         if(nr==4) traits.initAcc(C3);</span>
<span class="lineNum">     575 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :                   traits.initAcc(C4);</span>
<span class="lineNum">     576 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :                   traits.initAcc(C5);</span>
<span class="lineNum">     577 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :         if(nr==4) traits.initAcc(C6);</span>
<span class="lineNum">     578 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :         if(nr==4) traits.initAcc(C7);</span>
<span class="lineNum">     579 </span>                :            : 
<span class="lineNum">     580 </span>                :<span class="lineCov">        613 :         ResScalar* r0 = &amp;res[(j2+0)*resStride + i];</span>
<span class="lineNum">     581 </span>                :<span class="lineCov">        613 :         ResScalar* r1 = r0 + resStride;</span>
<span class="lineNum">     582 </span>                :<span class="lineCov">        613 :         ResScalar* r2 = r1 + resStride;</span>
<span class="lineNum">     583 </span>                :<span class="lineCov">        613 :         ResScalar* r3 = r2 + resStride;</span>
<span class="lineNum">     584 </span>                :            : 
<span class="lineNum">     585 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :         prefetch(r0+16);</span>
<span class="lineNum">     586 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :         prefetch(r1+16);</span>
<span class="lineNum">     587 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :         prefetch(r2+16);</span>
<span class="lineNum">     588 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :         prefetch(r3+16);</span>
<span class="lineNum">     589 </span>                :            : 
<span class="lineNum">     590 </span>                :            :         // performs &quot;inner&quot; product
<span class="lineNum">     591 </span>                :            :         // TODO let's check wether the folowing peeled loop could not be
<span class="lineNum">     592 </span>                :            :         //      optimized via optimal prefetching from one loop to the other
<span class="lineNum">     593 </span>                :<span class="lineCov">        613 :         const RhsScalar* blB = unpackedB;</span>
<span class="lineNum">     594 </span>[<span class="branchCov" title="Branch 0 was taken 461 times"> + </span><span class="branchCov" title="Branch 1 was taken 613 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       1074 :         for(Index k=0; k&lt;peeled_kc; k+=4)</span>
<span class="lineNum">     595 </span>                :            :         {
<span class="lineNum">     596 </span>                :            :           if(nr==2)
<span class="lineNum">     597 </span>                :            :           {
<span class="lineNum">     598 </span>                :            :             LhsPacket A0, A1;
<span class="lineNum">     599 </span>                :            :             RhsPacket B_0;
<span class="lineNum">     600 </span>                :            :             RhsPacket T0;
<span class="lineNum">     601 </span>                :            :             
<span class="lineNum">     602 </span>                :            : EIGEN_ASM_COMMENT(&quot;mybegin2&quot;);
<span class="lineNum">     603 </span>                :            :             traits.loadLhs(&amp;blA[0*LhsProgress], A0);
<span class="lineNum">     604 </span>                :            :             traits.loadLhs(&amp;blA[1*LhsProgress], A1);
<span class="lineNum">     605 </span>                :            :             traits.loadRhs(&amp;blB[0*RhsProgress], B_0);
<span class="lineNum">     606 </span>                :            :             traits.madd(A0,B_0,C0,T0);
<span class="lineNum">     607 </span>                :            :             traits.madd(A1,B_0,C4,B_0);
<span class="lineNum">     608 </span>                :            :             traits.loadRhs(&amp;blB[1*RhsProgress], B_0);
<span class="lineNum">     609 </span>                :            :             traits.madd(A0,B_0,C1,T0);
<span class="lineNum">     610 </span>                :            :             traits.madd(A1,B_0,C5,B_0);
<span class="lineNum">     611 </span>                :            : 
<span class="lineNum">     612 </span>                :            :             traits.loadLhs(&amp;blA[2*LhsProgress], A0);
<span class="lineNum">     613 </span>                :            :             traits.loadLhs(&amp;blA[3*LhsProgress], A1);
<span class="lineNum">     614 </span>                :            :             traits.loadRhs(&amp;blB[2*RhsProgress], B_0);
<span class="lineNum">     615 </span>                :            :             traits.madd(A0,B_0,C0,T0);
<span class="lineNum">     616 </span>                :            :             traits.madd(A1,B_0,C4,B_0);
<span class="lineNum">     617 </span>                :            :             traits.loadRhs(&amp;blB[3*RhsProgress], B_0);
<span class="lineNum">     618 </span>                :            :             traits.madd(A0,B_0,C1,T0);
<span class="lineNum">     619 </span>                :            :             traits.madd(A1,B_0,C5,B_0);
<span class="lineNum">     620 </span>                :            : 
<span class="lineNum">     621 </span>                :            :             traits.loadLhs(&amp;blA[4*LhsProgress], A0);
<span class="lineNum">     622 </span>                :            :             traits.loadLhs(&amp;blA[5*LhsProgress], A1);
<span class="lineNum">     623 </span>                :            :             traits.loadRhs(&amp;blB[4*RhsProgress], B_0);
<span class="lineNum">     624 </span>                :            :             traits.madd(A0,B_0,C0,T0);
<span class="lineNum">     625 </span>                :            :             traits.madd(A1,B_0,C4,B_0);
<span class="lineNum">     626 </span>                :            :             traits.loadRhs(&amp;blB[5*RhsProgress], B_0);
<span class="lineNum">     627 </span>                :            :             traits.madd(A0,B_0,C1,T0);
<span class="lineNum">     628 </span>                :            :             traits.madd(A1,B_0,C5,B_0);
<span class="lineNum">     629 </span>                :            : 
<span class="lineNum">     630 </span>                :            :             traits.loadLhs(&amp;blA[6*LhsProgress], A0);
<span class="lineNum">     631 </span>                :            :             traits.loadLhs(&amp;blA[7*LhsProgress], A1);
<span class="lineNum">     632 </span>                :            :             traits.loadRhs(&amp;blB[6*RhsProgress], B_0);
<span class="lineNum">     633 </span>                :            :             traits.madd(A0,B_0,C0,T0);
<span class="lineNum">     634 </span>                :            :             traits.madd(A1,B_0,C4,B_0);
<span class="lineNum">     635 </span>                :            :             traits.loadRhs(&amp;blB[7*RhsProgress], B_0);
<span class="lineNum">     636 </span>                :            :             traits.madd(A0,B_0,C1,T0);
<span class="lineNum">     637 </span>                :            :             traits.madd(A1,B_0,C5,B_0);
<span class="lineNum">     638 </span>                :            : EIGEN_ASM_COMMENT(&quot;myend&quot;);
<span class="lineNum">     639 </span>                :            :           }
<span class="lineNum">     640 </span>                :            :           else
<span class="lineNum">     641 </span>                :            :           {
<span class="lineNum">     642 </span>                :<span class="lineCov">        461 : EIGEN_ASM_COMMENT(&quot;mybegin4&quot;);</span>
<span class="lineNum">     643 </span>                :            :             LhsPacket A0, A1;
<span class="lineNum">     644 </span>                :            :             RhsPacket B_0, B1, B2, B3;
<span class="lineNum">     645 </span>                :            :             RhsPacket T0;
<span class="lineNum">     646 </span>                :            :             
<span class="lineNum">     647 </span>  [<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadLhs(&amp;blA[0*LhsProgress], A0);</span>
<span class="lineNum">     648 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadLhs(&amp;blA[1*LhsProgress], A1);</span>
<span class="lineNum">     649 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[0*RhsProgress], B_0);</span>
<span class="lineNum">     650 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[1*RhsProgress], B1);</span>
<span class="lineNum">     651 </span>                :            : 
<span class="lineNum">     652 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B_0,C0,T0);</span>
<span class="lineNum">     653 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[2*RhsProgress], B2);</span>
<span class="lineNum">     654 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B_0,C4,B_0);</span>
<span class="lineNum">     655 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[3*RhsProgress], B3);</span>
<span class="lineNum">     656 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[4*RhsProgress], B_0);</span>
<span class="lineNum">     657 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B1,C1,T0);</span>
<span class="lineNum">     658 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B1,C5,B1);</span>
<span class="lineNum">     659 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[5*RhsProgress], B1);</span>
<span class="lineNum">     660 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B2,C2,T0);</span>
<span class="lineNum">     661 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B2,C6,B2);</span>
<span class="lineNum">     662 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[6*RhsProgress], B2);</span>
<span class="lineNum">     663 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B3,C3,T0);</span>
<span class="lineNum">     664 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadLhs(&amp;blA[2*LhsProgress], A0);</span>
<span class="lineNum">     665 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B3,C7,B3);</span>
<span class="lineNum">     666 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadLhs(&amp;blA[3*LhsProgress], A1);</span>
<span class="lineNum">     667 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[7*RhsProgress], B3);</span>
<span class="lineNum">     668 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B_0,C0,T0);</span>
<span class="lineNum">     669 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B_0,C4,B_0);</span>
<span class="lineNum">     670 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[8*RhsProgress], B_0);</span>
<span class="lineNum">     671 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B1,C1,T0);</span>
<span class="lineNum">     672 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B1,C5,B1);</span>
<span class="lineNum">     673 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[9*RhsProgress], B1);</span>
<span class="lineNum">     674 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B2,C2,T0);</span>
<span class="lineNum">     675 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B2,C6,B2);</span>
<span class="lineNum">     676 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[10*RhsProgress], B2);</span>
<span class="lineNum">     677 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B3,C3,T0);</span>
<span class="lineNum">     678 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadLhs(&amp;blA[4*LhsProgress], A0);</span>
<span class="lineNum">     679 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B3,C7,B3);</span>
<span class="lineNum">     680 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadLhs(&amp;blA[5*LhsProgress], A1);</span>
<span class="lineNum">     681 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[11*RhsProgress], B3);</span>
<span class="lineNum">     682 </span>                :            : 
<span class="lineNum">     683 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B_0,C0,T0);</span>
<span class="lineNum">     684 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B_0,C4,B_0);</span>
<span class="lineNum">     685 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[12*RhsProgress], B_0);</span>
<span class="lineNum">     686 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B1,C1,T0);</span>
<span class="lineNum">     687 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B1,C5,B1);</span>
<span class="lineNum">     688 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[13*RhsProgress], B1);</span>
<span class="lineNum">     689 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B2,C2,T0);</span>
<span class="lineNum">     690 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B2,C6,B2);</span>
<span class="lineNum">     691 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[14*RhsProgress], B2);</span>
<span class="lineNum">     692 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B3,C3,T0);</span>
<span class="lineNum">     693 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadLhs(&amp;blA[6*LhsProgress], A0);</span>
<span class="lineNum">     694 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B3,C7,B3);</span>
<span class="lineNum">     695 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadLhs(&amp;blA[7*LhsProgress], A1);</span>
<span class="lineNum">     696 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.loadRhs(&amp;blB[15*RhsProgress], B3);</span>
<span class="lineNum">     697 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B_0,C0,T0);</span>
<span class="lineNum">     698 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B_0,C4,B_0);</span>
<span class="lineNum">     699 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B1,C1,T0);</span>
<span class="lineNum">     700 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B1,C5,B1);</span>
<span class="lineNum">     701 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B2,C2,T0);</span>
<span class="lineNum">     702 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B2,C6,B2);</span>
<span class="lineNum">     703 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A0,B3,C3,T0);</span>
<span class="lineNum">     704 </span>[<span class="branchCov" title="Branch 1 was taken 461 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        461 :             traits.madd(A1,B3,C7,B3);</span>
<span class="lineNum">     705 </span>                :            :           }
<span class="lineNum">     706 </span>                :            : 
<span class="lineNum">     707 </span>                :<span class="lineCov">        461 :           blB += 4*nr*RhsProgress;</span>
<span class="lineNum">     708 </span>                :<span class="lineCov">        461 :           blA += 4*mr;</span>
<span class="lineNum">     709 </span>                :            :         }
<span class="lineNum">     710 </span>                :            :         // process remaining peeled loop
<span class="lineNum">     711 </span>[<span class="branchCov" title="Branch 0 was taken 162 times"> + </span><span class="branchCov" title="Branch 1 was taken 613 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">        775 :         for(Index k=peeled_kc; k&lt;depth; k++)</span>
<span class="lineNum">     712 </span>                :            :         {
<span class="lineNum">     713 </span>                :            :           if(nr==2)
<span class="lineNum">     714 </span>                :            :           {
<span class="lineNum">     715 </span>                :            :             LhsPacket A0, A1;
<span class="lineNum">     716 </span>                :            :             RhsPacket B_0;
<span class="lineNum">     717 </span>                :            :             RhsPacket T0;
<span class="lineNum">     718 </span>                :            : 
<span class="lineNum">     719 </span>                :            :             traits.loadLhs(&amp;blA[0*LhsProgress], A0);
<span class="lineNum">     720 </span>                :            :             traits.loadLhs(&amp;blA[1*LhsProgress], A1);
<span class="lineNum">     721 </span>                :            :             traits.loadRhs(&amp;blB[0*RhsProgress], B_0);
<span class="lineNum">     722 </span>                :            :             traits.madd(A0,B_0,C0,T0);
<span class="lineNum">     723 </span>                :            :             traits.madd(A1,B_0,C4,B_0);
<span class="lineNum">     724 </span>                :            :             traits.loadRhs(&amp;blB[1*RhsProgress], B_0);
<span class="lineNum">     725 </span>                :            :             traits.madd(A0,B_0,C1,T0);
<span class="lineNum">     726 </span>                :            :             traits.madd(A1,B_0,C5,B_0);
<span class="lineNum">     727 </span>                :            :           }
<span class="lineNum">     728 </span>                :            :           else
<span class="lineNum">     729 </span>                :            :           {
<span class="lineNum">     730 </span>                :            :             LhsPacket A0, A1;
<span class="lineNum">     731 </span>                :            :             RhsPacket B_0, B1, B2, B3;
<span class="lineNum">     732 </span>                :            :             RhsPacket T0;
<span class="lineNum">     733 </span>                :            : 
<span class="lineNum">     734 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.loadLhs(&amp;blA[0*LhsProgress], A0);</span>
<span class="lineNum">     735 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.loadLhs(&amp;blA[1*LhsProgress], A1);</span>
<span class="lineNum">     736 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.loadRhs(&amp;blB[0*RhsProgress], B_0);</span>
<span class="lineNum">     737 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.loadRhs(&amp;blB[1*RhsProgress], B1);</span>
<span class="lineNum">     738 </span>                :            : 
<span class="lineNum">     739 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.madd(A0,B_0,C0,T0);</span>
<span class="lineNum">     740 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.loadRhs(&amp;blB[2*RhsProgress], B2);</span>
<span class="lineNum">     741 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.madd(A1,B_0,C4,B_0);</span>
<span class="lineNum">     742 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.loadRhs(&amp;blB[3*RhsProgress], B3);</span>
<span class="lineNum">     743 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.madd(A0,B1,C1,T0);</span>
<span class="lineNum">     744 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.madd(A1,B1,C5,B1);</span>
<span class="lineNum">     745 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.madd(A0,B2,C2,T0);</span>
<span class="lineNum">     746 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.madd(A1,B2,C6,B2);</span>
<span class="lineNum">     747 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.madd(A0,B3,C3,T0);</span>
<span class="lineNum">     748 </span>[<span class="branchCov" title="Branch 1 was taken 162 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        162 :             traits.madd(A1,B3,C7,B3);</span>
<span class="lineNum">     749 </span>                :            :           }
<span class="lineNum">     750 </span>                :            : 
<span class="lineNum">     751 </span>                :<span class="lineCov">        162 :           blB += nr*RhsProgress;</span>
<span class="lineNum">     752 </span>                :<span class="lineCov">        162 :           blA += mr;</span>
<span class="lineNum">     753 </span>                :            :         }
<span class="lineNum">     754 </span>                :            : 
<span class="lineNum">     755 </span>                :            :         if(nr==4)
<span class="lineNum">     756 </span>                :            :         {
<span class="lineNum">     757 </span>                :            :           ResPacket R0, R1, R2, R3, R4, R5, R6;
<span class="lineNum">     758 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           ResPacket alphav = pset1&lt;ResPacket&gt;(alpha);</span>
<span class="lineNum">     759 </span>                :            : 
<span class="lineNum">     760 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           R0 = ploadu&lt;ResPacket&gt;(r0);</span>
<span class="lineNum">     761 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           R1 = ploadu&lt;ResPacket&gt;(r1);</span>
<span class="lineNum">     762 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           R2 = ploadu&lt;ResPacket&gt;(r2);</span>
<span class="lineNum">     763 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           R3 = ploadu&lt;ResPacket&gt;(r3);</span>
<span class="lineNum">     764 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           R4 = ploadu&lt;ResPacket&gt;(r0 + ResPacketSize);</span>
<span class="lineNum">     765 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           R5 = ploadu&lt;ResPacket&gt;(r1 + ResPacketSize);</span>
<span class="lineNum">     766 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           R6 = ploadu&lt;ResPacket&gt;(r2 + ResPacketSize);</span>
<span class="lineNum">     767 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           traits.acc(C0, alphav, R0);</span>
<span class="lineNum">     768 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           pstoreu(r0, R0);</span>
<span class="lineNum">     769 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           R0 = ploadu&lt;ResPacket&gt;(r3 + ResPacketSize);</span>
<span class="lineNum">     770 </span>                :            : 
<span class="lineNum">     771 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           traits.acc(C1, alphav, R1);</span>
<span class="lineNum">     772 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           traits.acc(C2, alphav, R2);</span>
<span class="lineNum">     773 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           traits.acc(C3, alphav, R3);</span>
<span class="lineNum">     774 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           traits.acc(C4, alphav, R4);</span>
<span class="lineNum">     775 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           traits.acc(C5, alphav, R5);</span>
<span class="lineNum">     776 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           traits.acc(C6, alphav, R6);</span>
<span class="lineNum">     777 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           traits.acc(C7, alphav, R0);</span>
<span class="lineNum">     778 </span>                :            :           
<span class="lineNum">     779 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           pstoreu(r1, R1);</span>
<span class="lineNum">     780 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           pstoreu(r2, R2);</span>
<span class="lineNum">     781 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           pstoreu(r3, R3);</span>
<span class="lineNum">     782 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           pstoreu(r0 + ResPacketSize, R4);</span>
<span class="lineNum">     783 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           pstoreu(r1 + ResPacketSize, R5);</span>
<span class="lineNum">     784 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           pstoreu(r2 + ResPacketSize, R6);</span>
<span class="lineNum">     785 </span>[<span class="branchCov" title="Branch 1 was taken 613 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        613 :           pstoreu(r3 + ResPacketSize, R0);</span>
<span class="lineNum">     786 </span>                :            :         }
<span class="lineNum">     787 </span>                :            :         else
<span class="lineNum">     788 </span>                :            :         {
<span class="lineNum">     789 </span>                :            :           ResPacket R0, R1, R4;
<span class="lineNum">     790 </span>                :            :           ResPacket alphav = pset1&lt;ResPacket&gt;(alpha);
<span class="lineNum">     791 </span>                :            : 
<span class="lineNum">     792 </span>                :            :           R0 = ploadu&lt;ResPacket&gt;(r0);
<span class="lineNum">     793 </span>                :            :           R1 = ploadu&lt;ResPacket&gt;(r1);
<span class="lineNum">     794 </span>                :            :           R4 = ploadu&lt;ResPacket&gt;(r0 + ResPacketSize);
<span class="lineNum">     795 </span>                :            :           traits.acc(C0, alphav, R0);
<span class="lineNum">     796 </span>                :            :           pstoreu(r0, R0);
<span class="lineNum">     797 </span>                :            :           R0 = ploadu&lt;ResPacket&gt;(r1 + ResPacketSize);
<span class="lineNum">     798 </span>                :            :           traits.acc(C1, alphav, R1);
<span class="lineNum">     799 </span>                :            :           traits.acc(C4, alphav, R4);
<span class="lineNum">     800 </span>                :            :           traits.acc(C5, alphav, R0);
<span class="lineNum">     801 </span>                :            :           pstoreu(r1, R1);
<span class="lineNum">     802 </span>                :            :           pstoreu(r0 + ResPacketSize, R4);
<span class="lineNum">     803 </span>                :            :           pstoreu(r1 + ResPacketSize, R0);
<span class="lineNum">     804 </span>                :            :         }
<span class="lineNum">     805 </span>                :            :         
<span class="lineNum">     806 </span>                :            :       }
<span class="lineNum">     807 </span>                :            :       
<span class="lineNum">     808 </span>[<span class="branchCov" title="Branch 0 was taken 15 times"> + </span><span class="branchCov" title="Branch 1 was taken 1060 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       1075 :       if(rows-peeled_mc&gt;=LhsProgress)</span>
<span class="lineNum">     809 </span>                :            :       {
<span class="lineNum">     810 </span>                :<span class="lineCov">         15 :         Index i = peeled_mc;</span>
<span class="lineNum">     811 </span>                :<span class="lineCov">         15 :         const LhsScalar* blA = &amp;blockA[i*strideA+offsetA*LhsProgress];</span>
<span class="lineNum">     812 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         prefetch(&amp;blA[0]);</span>
<span class="lineNum">     813 </span>                :            : 
<span class="lineNum">     814 </span>                :            :         // gets res block as register
<span class="lineNum">     815 </span>                :            :         AccPacket C0, C1, C2, C3;
<span class="lineNum">     816 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :                   traits.initAcc(C0);</span>
<span class="lineNum">     817 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :                   traits.initAcc(C1);</span>
<span class="lineNum">     818 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         if(nr==4) traits.initAcc(C2);</span>
<span class="lineNum">     819 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         if(nr==4) traits.initAcc(C3);</span>
<span class="lineNum">     820 </span>                :            : 
<span class="lineNum">     821 </span>                :            :         // performs &quot;inner&quot; product
<span class="lineNum">     822 </span>                :<span class="lineCov">         15 :         const RhsScalar* blB = unpackedB;</span>
<span class="lineNum">     823 </span>[<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchCov" title="Branch 1 was taken 15 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">         28 :         for(Index k=0; k&lt;peeled_kc; k+=4)</span>
<span class="lineNum">     824 </span>                :            :         {
<span class="lineNum">     825 </span>                :            :           if(nr==2)
<span class="lineNum">     826 </span>                :            :           {
<span class="lineNum">     827 </span>                :            :             LhsPacket A0;
<span class="lineNum">     828 </span>                :            :             RhsPacket B_0, B1;
<span class="lineNum">     829 </span>                :            : 
<span class="lineNum">     830 </span>                :            :             traits.loadLhs(&amp;blA[0*LhsProgress], A0);
<span class="lineNum">     831 </span>                :            :             traits.loadRhs(&amp;blB[0*RhsProgress], B_0);
<span class="lineNum">     832 </span>                :            :             traits.loadRhs(&amp;blB[1*RhsProgress], B1);
<span class="lineNum">     833 </span>                :            :             traits.madd(A0,B_0,C0,B_0);
<span class="lineNum">     834 </span>                :            :             traits.loadRhs(&amp;blB[2*RhsProgress], B_0);
<span class="lineNum">     835 </span>                :            :             traits.madd(A0,B1,C1,B1);
<span class="lineNum">     836 </span>                :            :             traits.loadLhs(&amp;blA[1*LhsProgress], A0);
<span class="lineNum">     837 </span>                :            :             traits.loadRhs(&amp;blB[3*RhsProgress], B1);
<span class="lineNum">     838 </span>                :            :             traits.madd(A0,B_0,C0,B_0);
<span class="lineNum">     839 </span>                :            :             traits.loadRhs(&amp;blB[4*RhsProgress], B_0);
<span class="lineNum">     840 </span>                :            :             traits.madd(A0,B1,C1,B1);
<span class="lineNum">     841 </span>                :            :             traits.loadLhs(&amp;blA[2*LhsProgress], A0);
<span class="lineNum">     842 </span>                :            :             traits.loadRhs(&amp;blB[5*RhsProgress], B1);
<span class="lineNum">     843 </span>                :            :             traits.madd(A0,B_0,C0,B_0);
<span class="lineNum">     844 </span>                :            :             traits.loadRhs(&amp;blB[6*RhsProgress], B_0);
<span class="lineNum">     845 </span>                :            :             traits.madd(A0,B1,C1,B1);
<span class="lineNum">     846 </span>                :            :             traits.loadLhs(&amp;blA[3*LhsProgress], A0);
<span class="lineNum">     847 </span>                :            :             traits.loadRhs(&amp;blB[7*RhsProgress], B1);
<span class="lineNum">     848 </span>                :            :             traits.madd(A0,B_0,C0,B_0);
<span class="lineNum">     849 </span>                :            :             traits.madd(A0,B1,C1,B1);
<span class="lineNum">     850 </span>                :            :           }
<span class="lineNum">     851 </span>                :            :           else
<span class="lineNum">     852 </span>                :            :           {
<span class="lineNum">     853 </span>                :            :             LhsPacket A0;
<span class="lineNum">     854 </span>                :            :             RhsPacket B_0, B1, B2, B3;
<span class="lineNum">     855 </span>                :            : 
<span class="lineNum">     856 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadLhs(&amp;blA[0*LhsProgress], A0);</span>
<span class="lineNum">     857 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[0*RhsProgress], B_0);</span>
<span class="lineNum">     858 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[1*RhsProgress], B1);</span>
<span class="lineNum">     859 </span>                :            : 
<span class="lineNum">     860 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B_0,C0,B_0);</span>
<span class="lineNum">     861 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[2*RhsProgress], B2);</span>
<span class="lineNum">     862 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[3*RhsProgress], B3);</span>
<span class="lineNum">     863 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[4*RhsProgress], B_0);</span>
<span class="lineNum">     864 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B1,C1,B1);</span>
<span class="lineNum">     865 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[5*RhsProgress], B1);</span>
<span class="lineNum">     866 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B2,C2,B2);</span>
<span class="lineNum">     867 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[6*RhsProgress], B2);</span>
<span class="lineNum">     868 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B3,C3,B3);</span>
<span class="lineNum">     869 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadLhs(&amp;blA[1*LhsProgress], A0);</span>
<span class="lineNum">     870 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[7*RhsProgress], B3);</span>
<span class="lineNum">     871 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B_0,C0,B_0);</span>
<span class="lineNum">     872 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[8*RhsProgress], B_0);</span>
<span class="lineNum">     873 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B1,C1,B1);</span>
<span class="lineNum">     874 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[9*RhsProgress], B1);</span>
<span class="lineNum">     875 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B2,C2,B2);</span>
<span class="lineNum">     876 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[10*RhsProgress], B2);</span>
<span class="lineNum">     877 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B3,C3,B3);</span>
<span class="lineNum">     878 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadLhs(&amp;blA[2*LhsProgress], A0);</span>
<span class="lineNum">     879 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[11*RhsProgress], B3);</span>
<span class="lineNum">     880 </span>                :            : 
<span class="lineNum">     881 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B_0,C0,B_0);</span>
<span class="lineNum">     882 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[12*RhsProgress], B_0);</span>
<span class="lineNum">     883 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B1,C1,B1);</span>
<span class="lineNum">     884 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[13*RhsProgress], B1);</span>
<span class="lineNum">     885 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B2,C2,B2);</span>
<span class="lineNum">     886 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[14*RhsProgress], B2);</span>
<span class="lineNum">     887 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B3,C3,B3);</span>
<span class="lineNum">     888 </span>                :            : 
<span class="lineNum">     889 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadLhs(&amp;blA[3*LhsProgress], A0);</span>
<span class="lineNum">     890 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.loadRhs(&amp;blB[15*RhsProgress], B3);</span>
<span class="lineNum">     891 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B_0,C0,B_0);</span>
<span class="lineNum">     892 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B1,C1,B1);</span>
<span class="lineNum">     893 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B2,C2,B2);</span>
<span class="lineNum">     894 </span>[<span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         13 :             traits.madd(A0,B3,C3,B3);</span>
<span class="lineNum">     895 </span>                :            :           }
<span class="lineNum">     896 </span>                :            : 
<span class="lineNum">     897 </span>                :<span class="lineCov">         13 :           blB += nr*4*RhsProgress;</span>
<span class="lineNum">     898 </span>                :<span class="lineCov">         13 :           blA += 4*LhsProgress;</span>
<span class="lineNum">     899 </span>                :            :         }
<span class="lineNum">     900 </span>                :            :         // process remaining peeled loop
<span class="lineNum">     901 </span>[<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 15 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">         27 :         for(Index k=peeled_kc; k&lt;depth; k++)</span>
<span class="lineNum">     902 </span>                :            :         {
<span class="lineNum">     903 </span>                :            :           if(nr==2)
<span class="lineNum">     904 </span>                :            :           {
<span class="lineNum">     905 </span>                :            :             LhsPacket A0;
<span class="lineNum">     906 </span>                :            :             RhsPacket B_0, B1;
<span class="lineNum">     907 </span>                :            : 
<span class="lineNum">     908 </span>                :            :             traits.loadLhs(&amp;blA[0*LhsProgress], A0);
<span class="lineNum">     909 </span>                :            :             traits.loadRhs(&amp;blB[0*RhsProgress], B_0);
<span class="lineNum">     910 </span>                :            :             traits.loadRhs(&amp;blB[1*RhsProgress], B1);
<span class="lineNum">     911 </span>                :            :             traits.madd(A0,B_0,C0,B_0);
<span class="lineNum">     912 </span>                :            :             traits.madd(A0,B1,C1,B1);
<span class="lineNum">     913 </span>                :            :           }
<span class="lineNum">     914 </span>                :            :           else
<span class="lineNum">     915 </span>                :            :           {
<span class="lineNum">     916 </span>                :            :             LhsPacket A0;
<span class="lineNum">     917 </span>                :            :             RhsPacket B_0, B1, B2, B3;
<span class="lineNum">     918 </span>                :            : 
<span class="lineNum">     919 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :             traits.loadLhs(&amp;blA[0*LhsProgress], A0);</span>
<span class="lineNum">     920 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :             traits.loadRhs(&amp;blB[0*RhsProgress], B_0);</span>
<span class="lineNum">     921 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :             traits.loadRhs(&amp;blB[1*RhsProgress], B1);</span>
<span class="lineNum">     922 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :             traits.loadRhs(&amp;blB[2*RhsProgress], B2);</span>
<span class="lineNum">     923 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :             traits.loadRhs(&amp;blB[3*RhsProgress], B3);</span>
<span class="lineNum">     924 </span>                :            : 
<span class="lineNum">     925 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :             traits.madd(A0,B_0,C0,B_0);</span>
<span class="lineNum">     926 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :             traits.madd(A0,B1,C1,B1);</span>
<span class="lineNum">     927 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :             traits.madd(A0,B2,C2,B2);</span>
<span class="lineNum">     928 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :             traits.madd(A0,B3,C3,B3);</span>
<span class="lineNum">     929 </span>                :            :           }
<span class="lineNum">     930 </span>                :            : 
<span class="lineNum">     931 </span>                :<span class="lineCov">         12 :           blB += nr*RhsProgress;</span>
<span class="lineNum">     932 </span>                :<span class="lineCov">         12 :           blA += LhsProgress;</span>
<span class="lineNum">     933 </span>                :            :         }
<span class="lineNum">     934 </span>                :            : 
<span class="lineNum">     935 </span>                :            :         ResPacket R0, R1, R2, R3;
<span class="lineNum">     936 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         ResPacket alphav = pset1&lt;ResPacket&gt;(alpha);</span>
<span class="lineNum">     937 </span>                :            : 
<span class="lineNum">     938 </span>                :<span class="lineCov">         15 :         ResScalar* r0 = &amp;res[(j2+0)*resStride + i];</span>
<span class="lineNum">     939 </span>                :<span class="lineCov">         15 :         ResScalar* r1 = r0 + resStride;</span>
<span class="lineNum">     940 </span>                :<span class="lineCov">         15 :         ResScalar* r2 = r1 + resStride;</span>
<span class="lineNum">     941 </span>                :<span class="lineCov">         15 :         ResScalar* r3 = r2 + resStride;</span>
<span class="lineNum">     942 </span>                :            : 
<span class="lineNum">     943 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :                   R0 = ploadu&lt;ResPacket&gt;(r0);</span>
<span class="lineNum">     944 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :                   R1 = ploadu&lt;ResPacket&gt;(r1);</span>
<span class="lineNum">     945 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         if(nr==4) R2 = ploadu&lt;ResPacket&gt;(r2);</span>
<span class="lineNum">     946 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         if(nr==4) R3 = ploadu&lt;ResPacket&gt;(r3);</span>
<span class="lineNum">     947 </span>                :            : 
<span class="lineNum">     948 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :                   traits.acc(C0, alphav, R0);</span>
<span class="lineNum">     949 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :                   traits.acc(C1, alphav, R1);</span>
<span class="lineNum">     950 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         if(nr==4) traits.acc(C2, alphav, R2);</span>
<span class="lineNum">     951 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         if(nr==4) traits.acc(C3, alphav, R3);</span>
<span class="lineNum">     952 </span>                :            : 
<span class="lineNum">     953 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :                   pstoreu(r0, R0);</span>
<span class="lineNum">     954 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :                   pstoreu(r1, R1);</span>
<span class="lineNum">     955 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         if(nr==4) pstoreu(r2, R2);</span>
<span class="lineNum">     956 </span>[<span class="branchCov" title="Branch 1 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         15 :         if(nr==4) pstoreu(r3, R3);</span>
<span class="lineNum">     957 </span>                :            :       }
<span class="lineNum">     958 </span>[<span class="branchCov" title="Branch 0 was taken 454 times"> + </span><span class="branchCov" title="Branch 1 was taken 1075 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       1529 :       for(Index i=peeled_mc2; i&lt;rows; i++)</span>
<span class="lineNum">     959 </span>                :            :       {
<span class="lineNum">     960 </span>                :<span class="lineCov">        454 :         const LhsScalar* blA = &amp;blockA[i*strideA+offsetA];</span>
<span class="lineNum">     961 </span>[<span class="branchCov" title="Branch 1 was taken 454 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        454 :         prefetch(&amp;blA[0]);</span>
<span class="lineNum">     962 </span>                :            : 
<span class="lineNum">     963 </span>                :            :         // gets a 1 x nr res block as registers
<span class="lineNum">     964 </span>                :<span class="lineCov">        454 :         ResScalar C0(0), C1(0), C2(0), C3(0);</span>
<span class="lineNum">     965 </span>                :            :         // TODO directly use blockB ???
<span class="lineNum">     966 </span>                :<span class="lineCov">        454 :         const RhsScalar* blB = &amp;blockB[j2*strideB+offsetB*nr];</span>
<span class="lineNum">     967 </span>[<span class="branchCov" title="Branch 0 was taken 1813 times"> + </span><span class="branchCov" title="Branch 1 was taken 454 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       2267 :         for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">     968 </span>                :            :         {
<span class="lineNum">     969 </span>                :            :           if(nr==2)
<span class="lineNum">     970 </span>                :            :           {
<span class="lineNum">     971 </span>                :            :             LhsScalar A0;
<span class="lineNum">     972 </span>                :            :             RhsScalar B_0, B1;
<span class="lineNum">     973 </span>                :            : 
<span class="lineNum">     974 </span>                :            :             A0 = blA[k];
<span class="lineNum">     975 </span>                :            :             B_0 = blB[0];
<span class="lineNum">     976 </span>                :            :             B1 = blB[1];
<span class="lineNum">     977 </span>                :            :             MADD(cj,A0,B_0,C0,B_0);
<span class="lineNum">     978 </span>                :            :             MADD(cj,A0,B1,C1,B1);
<span class="lineNum">     979 </span>                :            :           }
<span class="lineNum">     980 </span>                :            :           else
<span class="lineNum">     981 </span>                :            :           {
<span class="lineNum">     982 </span>                :            :             LhsScalar A0;
<span class="lineNum">     983 </span>                :            :             RhsScalar B_0, B1, B2, B3;
<span class="lineNum">     984 </span>                :            : 
<span class="lineNum">     985 </span>                :<span class="lineCov">       1813 :             A0 = blA[k];</span>
<span class="lineNum">     986 </span>                :<span class="lineCov">       1813 :             B_0 = blB[0];</span>
<span class="lineNum">     987 </span>                :<span class="lineCov">       1813 :             B1 = blB[1];</span>
<span class="lineNum">     988 </span>                :<span class="lineCov">       1813 :             B2 = blB[2];</span>
<span class="lineNum">     989 </span>                :<span class="lineCov">       1813 :             B3 = blB[3];</span>
<span class="lineNum">     990 </span>                :            : 
<span class="lineNum">     991 </span>[<span class="branchCov" title="Branch 1 was taken 1813 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">       1813 :             MADD(cj,A0,B_0,C0,B_0);</span>
<span class="lineNum">     992 </span>[<span class="branchCov" title="Branch 1 was taken 1813 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">       1813 :             MADD(cj,A0,B1,C1,B1);</span>
<span class="lineNum">     993 </span>[<span class="branchCov" title="Branch 1 was taken 1813 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">       1813 :             MADD(cj,A0,B2,C2,B2);</span>
<span class="lineNum">     994 </span>[<span class="branchCov" title="Branch 1 was taken 1813 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">       1813 :             MADD(cj,A0,B3,C3,B3);</span>
<span class="lineNum">     995 </span>                :            :           }
<span class="lineNum">     996 </span>                :            : 
<span class="lineNum">     997 </span>                :<span class="lineCov">       1813 :           blB += nr;</span>
<span class="lineNum">     998 </span>                :            :         }
<span class="lineNum">     999 </span>                :<span class="lineCov">        454 :                   res[(j2+0)*resStride + i] += alpha*C0;</span>
<span class="lineNum">    1000 </span>                :<span class="lineCov">        454 :                   res[(j2+1)*resStride + i] += alpha*C1;</span>
<span class="lineNum">    1001 </span>                :<span class="lineCov">        454 :         if(nr==4) res[(j2+2)*resStride + i] += alpha*C2;</span>
<span class="lineNum">    1002 </span>                :<span class="lineCov">        454 :         if(nr==4) res[(j2+3)*resStride + i] += alpha*C3;</span>
<span class="lineNum">    1003 </span>                :            :       }
<span class="lineNum">    1004 </span>                :            :     }
<span class="lineNum">    1005 </span>                :            :     // process remaining rhs/res columns one at a time
<span class="lineNum">    1006 </span>                :            :     // =&gt; do the same but with nr==1
<span class="lineNum">    1007 </span>[<span class="branchCov" title="Branch 0 was taken 486 times"> + </span><span class="branchCov" title="Branch 1 was taken 1531 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       2017 :     for(Index j2=packet_cols; j2&lt;cols; j2++)</span>
<span class="lineNum">    1008 </span>                :            :     {
<span class="lineNum">    1009 </span>                :            :       // unpack B
<span class="lineNum">    1010 </span>[<span class="branchCov" title="Branch 1 was taken 486 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        486 :       traits.unpackRhs(depth, &amp;blockB[j2*strideB+offsetB], unpackedB);</span>
<span class="lineNum">    1011 </span>                :            : 
<span class="lineNum">    1012 </span>[<span class="branchCov" title="Branch 0 was taken 316 times"> + </span><span class="branchCov" title="Branch 1 was taken 486 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">        802 :       for(Index i=0; i&lt;peeled_mc; i+=mr)</span>
<span class="lineNum">    1013 </span>                :            :       {
<span class="lineNum">    1014 </span>                :<span class="lineCov">        316 :         const LhsScalar* blA = &amp;blockA[i*strideA+offsetA*mr];</span>
<span class="lineNum">    1015 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         prefetch(&amp;blA[0]);</span>
<span class="lineNum">    1016 </span>                :            : 
<span class="lineNum">    1017 </span>                :            :         // TODO move the res loads to the stores
<span class="lineNum">    1018 </span>                :            : 
<span class="lineNum">    1019 </span>                :            :         // get res block as registers
<span class="lineNum">    1020 </span>                :            :         AccPacket C0, C4;
<span class="lineNum">    1021 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         traits.initAcc(C0);</span>
<span class="lineNum">    1022 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         traits.initAcc(C4);</span>
<span class="lineNum">    1023 </span>                :            : 
<span class="lineNum">    1024 </span>                :<span class="lineCov">        316 :         const RhsScalar* blB = unpackedB;</span>
<span class="lineNum">    1025 </span>[<span class="branchCov" title="Branch 0 was taken 824 times"> + </span><span class="branchCov" title="Branch 1 was taken 316 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       1140 :         for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">    1026 </span>                :            :         {
<span class="lineNum">    1027 </span>                :            :           LhsPacket A0, A1;
<span class="lineNum">    1028 </span>                :            :           RhsPacket B_0;
<span class="lineNum">    1029 </span>                :            :           RhsPacket T0;
<span class="lineNum">    1030 </span>                :            : 
<span class="lineNum">    1031 </span>[<span class="branchCov" title="Branch 1 was taken 824 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        824 :           traits.loadLhs(&amp;blA[0*LhsProgress], A0);</span>
<span class="lineNum">    1032 </span>[<span class="branchCov" title="Branch 1 was taken 824 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        824 :           traits.loadLhs(&amp;blA[1*LhsProgress], A1);</span>
<span class="lineNum">    1033 </span>[<span class="branchCov" title="Branch 1 was taken 824 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        824 :           traits.loadRhs(&amp;blB[0*RhsProgress], B_0);</span>
<span class="lineNum">    1034 </span>[<span class="branchCov" title="Branch 1 was taken 824 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        824 :           traits.madd(A0,B_0,C0,T0);</span>
<span class="lineNum">    1035 </span>[<span class="branchCov" title="Branch 1 was taken 824 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        824 :           traits.madd(A1,B_0,C4,B_0);</span>
<span class="lineNum">    1036 </span>                :            : 
<span class="lineNum">    1037 </span>                :<span class="lineCov">        824 :           blB += RhsProgress;</span>
<span class="lineNum">    1038 </span>                :<span class="lineCov">        824 :           blA += 2*LhsProgress;</span>
<span class="lineNum">    1039 </span>                :            :         }
<span class="lineNum">    1040 </span>                :            :         ResPacket R0, R4;
<span class="lineNum">    1041 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         ResPacket alphav = pset1&lt;ResPacket&gt;(alpha);</span>
<span class="lineNum">    1042 </span>                :            : 
<span class="lineNum">    1043 </span>                :<span class="lineCov">        316 :         ResScalar* r0 = &amp;res[(j2+0)*resStride + i];</span>
<span class="lineNum">    1044 </span>                :            : 
<span class="lineNum">    1045 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         R0 = ploadu&lt;ResPacket&gt;(r0);</span>
<span class="lineNum">    1046 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         R4 = ploadu&lt;ResPacket&gt;(r0+ResPacketSize);</span>
<span class="lineNum">    1047 </span>                :            : 
<span class="lineNum">    1048 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         traits.acc(C0, alphav, R0);</span>
<span class="lineNum">    1049 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         traits.acc(C4, alphav, R4);</span>
<span class="lineNum">    1050 </span>                :            : 
<span class="lineNum">    1051 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         pstoreu(r0,               R0);</span>
<span class="lineNum">    1052 </span>[<span class="branchCov" title="Branch 1 was taken 316 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        316 :         pstoreu(r0+ResPacketSize, R4);</span>
<span class="lineNum">    1053 </span>                :            :       }
<span class="lineNum">    1054 </span>[<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchCov" title="Branch 1 was taken 455 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">        486 :       if(rows-peeled_mc&gt;=LhsProgress)</span>
<span class="lineNum">    1055 </span>                :            :       {
<span class="lineNum">    1056 </span>                :<span class="lineCov">         31 :         Index i = peeled_mc;</span>
<span class="lineNum">    1057 </span>                :<span class="lineCov">         31 :         const LhsScalar* blA = &amp;blockA[i*strideA+offsetA*LhsProgress];</span>
<span class="lineNum">    1058 </span>[<span class="branchCov" title="Branch 1 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         31 :         prefetch(&amp;blA[0]);</span>
<span class="lineNum">    1059 </span>                :            : 
<span class="lineNum">    1060 </span>                :            :         AccPacket C0;
<span class="lineNum">    1061 </span>[<span class="branchCov" title="Branch 1 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         31 :         traits.initAcc(C0);</span>
<span class="lineNum">    1062 </span>                :            : 
<span class="lineNum">    1063 </span>                :<span class="lineCov">         31 :         const RhsScalar* blB = unpackedB;</span>
<span class="lineNum">    1064 </span>[<span class="branchCov" title="Branch 0 was taken 134 times"> + </span><span class="branchCov" title="Branch 1 was taken 31 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">        165 :         for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">    1065 </span>                :            :         {
<span class="lineNum">    1066 </span>                :            :           LhsPacket A0;
<span class="lineNum">    1067 </span>                :            :           RhsPacket B_0;
<span class="lineNum">    1068 </span>[<span class="branchCov" title="Branch 1 was taken 134 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        134 :           traits.loadLhs(blA, A0);</span>
<span class="lineNum">    1069 </span>[<span class="branchCov" title="Branch 1 was taken 134 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        134 :           traits.loadRhs(blB, B_0);</span>
<span class="lineNum">    1070 </span>[<span class="branchCov" title="Branch 1 was taken 134 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        134 :           traits.madd(A0, B_0, C0, B_0);</span>
<span class="lineNum">    1071 </span>                :<span class="lineCov">        134 :           blB += RhsProgress;</span>
<span class="lineNum">    1072 </span>                :<span class="lineCov">        134 :           blA += LhsProgress;</span>
<span class="lineNum">    1073 </span>                :            :         }
<span class="lineNum">    1074 </span>                :            : 
<span class="lineNum">    1075 </span>[<span class="branchCov" title="Branch 1 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         31 :         ResPacket alphav = pset1&lt;ResPacket&gt;(alpha);</span>
<span class="lineNum">    1076 </span>[<span class="branchCov" title="Branch 1 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         31 :         ResPacket R0 = ploadu&lt;ResPacket&gt;(&amp;res[(j2+0)*resStride + i]);</span>
<span class="lineNum">    1077 </span>[<span class="branchCov" title="Branch 1 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         31 :         traits.acc(C0, alphav, R0);</span>
<span class="lineNum">    1078 </span>[<span class="branchCov" title="Branch 1 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         31 :         pstoreu(&amp;res[(j2+0)*resStride + i], R0);</span>
<span class="lineNum">    1079 </span>                :            :       }
<span class="lineNum">    1080 </span>[<span class="branchCov" title="Branch 0 was taken 154 times"> + </span><span class="branchCov" title="Branch 1 was taken 486 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">        640 :       for(Index i=peeled_mc2; i&lt;rows; i++)</span>
<span class="lineNum">    1081 </span>                :            :       {
<span class="lineNum">    1082 </span>                :<span class="lineCov">        154 :         const LhsScalar* blA = &amp;blockA[i*strideA+offsetA];</span>
<span class="lineNum">    1083 </span>[<span class="branchCov" title="Branch 1 was taken 154 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        154 :         prefetch(&amp;blA[0]);</span>
<span class="lineNum">    1084 </span>                :            : 
<span class="lineNum">    1085 </span>                :            :         // gets a 1 x 1 res block as registers
<span class="lineNum">    1086 </span>                :<span class="lineCov">        154 :         ResScalar C0(0);</span>
<span class="lineNum">    1087 </span>                :            :         // FIXME directly use blockB ??
<span class="lineNum">    1088 </span>                :<span class="lineCov">        154 :         const RhsScalar* blB = &amp;blockB[j2*strideB+offsetB];</span>
<span class="lineNum">    1089 </span>[<span class="branchCov" title="Branch 0 was taken 616 times"> + </span><span class="branchCov" title="Branch 1 was taken 154 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">        770 :         for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">    1090 </span>                :            :         {
<span class="lineNum">    1091 </span>                :<span class="lineCov">        616 :           LhsScalar A0 = blA[k];</span>
<span class="lineNum">    1092 </span>                :<span class="lineCov">        616 :           RhsScalar B_0 = blB[k];</span>
<span class="lineNum">    1093 </span>[<span class="branchCov" title="Branch 1 was taken 616 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">        616 :           MADD(cj, A0, B_0, C0, B_0);</span>
<span class="lineNum">    1094 </span>                :            :         }
<span class="lineNum">    1095 </span>                :<span class="lineCov">        154 :         res[(j2+0)*resStride + i] += alpha*C0;</span>
<span class="lineNum">    1096 </span>                :            :       }
<span class="lineNum">    1097 </span>                :            :     }
<span class="lineNum">    1098 </span>                :<span class="lineCov">       1531 :   }</span>
<span class="lineNum">    1099 </span>                :            : 
<span class="lineNum">    1100 </span>                :            : 
<span class="lineNum">    1101 </span>                :            : #undef CJMADD
<span class="lineNum">    1102 </span>                :            : 
<span class="lineNum">    1103 </span>                :            : // pack a block of the lhs
<span class="lineNum">    1104 </span>                :            : // The traversal is as follow (mr==4):
<span class="lineNum">    1105 </span>                :            : //   0  4  8 12 ...
<span class="lineNum">    1106 </span>                :            : //   1  5  9 13 ...
<span class="lineNum">    1107 </span>                :            : //   2  6 10 14 ...
<span class="lineNum">    1108 </span>                :            : //   3  7 11 15 ...
<span class="lineNum">    1109 </span>                :            : //
<span class="lineNum">    1110 </span>                :            : //  16 20 24 28 ...
<span class="lineNum">    1111 </span>                :            : //  17 21 25 29 ...
<span class="lineNum">    1112 </span>                :            : //  18 22 26 30 ...
<span class="lineNum">    1113 </span>                :            : //  19 23 27 31 ...
<span class="lineNum">    1114 </span>                :            : //
<span class="lineNum">    1115 </span>                :            : //  32 33 34 35 ...
<span class="lineNum">    1116 </span>                :            : //  36 36 38 39 ...
<span class="lineNum">    1117 </span>                :            : template&lt;typename Scalar, typename Index, int Pack1, int Pack2, int StorageOrder, bool Conjugate, bool PanelMode&gt;
<span class="lineNum">    1118 </span>                :            : struct gemm_pack_lhs
<span class="lineNum">    1119 </span>                :            : {
<span class="lineNum">    1120 </span>                :            :   EIGEN_DONT_INLINE void operator()(Scalar* blockA, const Scalar* EIGEN_RESTRICT _lhs, Index lhsStride, Index depth, Index rows, Index stride=0, Index offset=0);
<span class="lineNum">    1121 </span>                :            : };
<a name="1122"><span class="lineNum">    1122 </span>                :            : </a>
<span class="lineNum">    1123 </span>                :            : template&lt;typename Scalar, typename Index, int Pack1, int Pack2, int StorageOrder, bool Conjugate, bool PanelMode&gt;
<span class="lineNum">    1124 </span>                :<span class="lineCov">       1531 : EIGEN_DONT_INLINE void gemm_pack_lhs&lt;Scalar, Index, Pack1, Pack2, StorageOrder, Conjugate, PanelMode&gt;</span>
<span class="lineNum">    1125 </span>                :            :   ::operator()(Scalar* blockA, const Scalar* EIGEN_RESTRICT _lhs, Index lhsStride, Index depth, Index rows, Index stride, Index offset)
<span class="lineNum">    1126 </span>                :            : {
<span class="lineNum">    1127 </span>                :            :   typedef typename packet_traits&lt;Scalar&gt;::type Packet;
<span class="lineNum">    1128 </span>                :            :   enum { PacketSize = packet_traits&lt;Scalar&gt;::size };
<span class="lineNum">    1129 </span>                :            : 
<span class="lineNum">    1130 </span>                :<span class="lineCov">       1531 :   EIGEN_ASM_COMMENT(&quot;EIGEN PRODUCT PACK LHS&quot;);</span>
<span class="lineNum">    1131 </span>  [<span class="branchCov" title="Branch 1 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span> :<span class="lineCov">       1531 :   EIGEN_UNUSED_VARIABLE(stride)</span>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<span class="lineNum">    1132 </span>[<span class="branchCov" title="Branch 1 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1531 :   EIGEN_UNUSED_VARIABLE(offset)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<span class="lineNum">    1133 </span>[<span class="branchCov" title="Branch 0 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 1515 times"> + </span>]:<span class="lineCov">       1531 :   eigen_assert(((!PanelMode) &amp;&amp; stride==0 &amp;&amp; offset==0) || (PanelMode &amp;&amp; stride&gt;=depth &amp;&amp; offset&lt;=stride));</span>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 16 times"> + </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>][<span class="branchNoExec" title="Branch 12 was not executed"> # </span><span class="branchNoExec" title="Branch 13 was not executed"> # </span>]
<span class="lineNum">    1134 </span>                :            :   eigen_assert( (StorageOrder==RowMajor) || ((Pack1%PacketSize)==0 &amp;&amp; Pack1&lt;=4*PacketSize) );
<span class="lineNum">    1135 </span>                :            :   conj_if&lt;NumTraits&lt;Scalar&gt;::IsComplex &amp;&amp; Conjugate&gt; cj;
<span class="lineNum">    1136 </span>[<span class="branchCov" title="Branch 1 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1531 :   const_blas_data_mapper&lt;Scalar, Index, StorageOrder&gt; lhs(_lhs,lhsStride);</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<span class="lineNum">    1137 </span>                :<span class="lineCov">       1531 :   Index count = 0;</span>
<span class="lineNum">    1138 </span>                :<span class="lineCov">       1531 :   Index peeled_mc = (rows/Pack1)*Pack1;</span>
<span class="lineNum">    1139 </span>[<span class="branchCov" title="Branch 0 was taken 907 times"> + </span><span class="branchCov" title="Branch 1 was taken 1515 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchCov" title="Branch 3 was taken 16 times"> + </span>]:<span class="lineCov">       2446 :   for(Index i=0; i&lt;peeled_mc; i+=Pack1)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<span class="lineNum">    1140 </span>                :            :   {
<span class="lineNum">    1141 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += Pack1 * offset;</span>
<span class="lineNum">    1142 </span>                :            : 
<span class="lineNum">    1143 </span>                :            :     if(StorageOrder==ColMajor)
<span class="lineNum">    1144 </span>                :            :     {
<span class="lineNum">    1145 </span>[<span class="branchCov" title="Branch 0 was taken 2744 times"> + </span><span class="branchCov" title="Branch 1 was taken 909 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       3653 :       for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">    1146 </span>                :            :       {
<span class="lineNum">    1147 </span>                :            :         Packet A, B, C, D;
<span class="lineNum">    1148 </span>[<span class="branchCov" title="Branch 1 was taken 2744 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2744 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       2744 :         if(Pack1&gt;=1*PacketSize) A = ploadu&lt;Packet&gt;(&amp;lhs(i+0*PacketSize, k));</span>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">    1149 </span>[<span class="branchCov" title="Branch 1 was taken 2744 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2744 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       2744 :         if(Pack1&gt;=2*PacketSize) B = ploadu&lt;Packet&gt;(&amp;lhs(i+1*PacketSize, k));</span>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">    1150 </span>                :            :         if(Pack1&gt;=3*PacketSize) C = ploadu&lt;Packet&gt;(&amp;lhs(i+2*PacketSize, k));
<span class="lineNum">    1151 </span>                :            :         if(Pack1&gt;=4*PacketSize) D = ploadu&lt;Packet&gt;(&amp;lhs(i+3*PacketSize, k));
<span class="lineNum">    1152 </span>[<span class="branchCov" title="Branch 1 was taken 2744 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2744 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       2744 :         if(Pack1&gt;=1*PacketSize) { pstore(blockA+count, cj.pconj(A)); count+=PacketSize; }</span>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">    1153 </span>[<span class="branchCov" title="Branch 1 was taken 2744 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2744 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       2744 :         if(Pack1&gt;=2*PacketSize) { pstore(blockA+count, cj.pconj(B)); count+=PacketSize; }</span>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">    1154 </span>                :            :         if(Pack1&gt;=3*PacketSize) { pstore(blockA+count, cj.pconj(C)); count+=PacketSize; }
<span class="lineNum">    1155 </span>                :            :         if(Pack1&gt;=4*PacketSize) { pstore(blockA+count, cj.pconj(D)); count+=PacketSize; }
<span class="lineNum">    1156 </span>                :            :       }
<span class="lineNum">    1157 </span>                :            :     }
<span class="lineNum">    1158 </span>                :            :     else
<span class="lineNum">    1159 </span>                :            :     {
<span class="lineNum">    1160 </span>        [<span class="branchCov" title="Branch 0 was taken 22 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">         28 :       for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">    1161 </span>                :            :       {
<span class="lineNum">    1162 </span>                :            :         // TODO add a vectorized transpose here
<span class="lineNum">    1163 </span>                :<span class="lineCov">         22 :         Index w=0;</span>
<span class="lineNum">    1164 </span>        [<span class="branchCov" title="Branch 0 was taken 22 times"> + </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span>]:<span class="lineCov">         44 :         for(; w&lt;Pack1-3; w+=4)</span>
<span class="lineNum">    1165 </span>                :            :         {
<span class="lineNum">    1166 </span>[<span class="branchCov" title="Branch 1 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         22 :           Scalar a(cj(lhs(i+w+0, k))),</span>
<span class="lineNum">    1167 </span>[<span class="branchCov" title="Branch 1 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         22 :                   b(cj(lhs(i+w+1, k))),</span>
<span class="lineNum">    1168 </span>[<span class="branchCov" title="Branch 1 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         22 :                   c(cj(lhs(i+w+2, k))),</span>
<span class="lineNum">    1169 </span>[<span class="branchCov" title="Branch 1 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">         22 :                   d(cj(lhs(i+w+3, k)));</span>
<span class="lineNum">    1170 </span>                :<span class="lineCov">         22 :           blockA[count++] = a;</span>
<span class="lineNum">    1171 </span>                :<span class="lineCov">         22 :           blockA[count++] = b;</span>
<span class="lineNum">    1172 </span>                :<span class="lineCov">         22 :           blockA[count++] = c;</span>
<span class="lineNum">    1173 </span>                :<span class="lineCov">         22 :           blockA[count++] = d;</span>
<span class="lineNum">    1174 </span>                :            :         }
<span class="lineNum">    1175 </span>                :            :         if(Pack1%4)
<span class="lineNum">    1176 </span>                :            :           for(;w&lt;Pack1;++w)
<span class="lineNum">    1177 </span>                :            :             blockA[count++] = cj(lhs(i+w, k));
<span class="lineNum">    1178 </span>                :            :       }
<span class="lineNum">    1179 </span>                :            :     }
<span class="lineNum">    1180 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += Pack1 * (stride-offset-depth);</span>
<span class="lineNum">    1181 </span>                :            :   }
<span class="lineNum">    1182 </span>[<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 1511 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span>]:<span class="lineCov">       1531 :   if(rows-peeled_mc&gt;=Pack2)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<span class="lineNum">    1183 </span>                :            :   {
<span class="lineNum">    1184 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += Pack2*offset;</span>
<span class="lineNum">    1185 </span>[<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 56 times"> + </span><span class="branchCov" title="Branch 3 was taken 12 times"> + </span>]:<span class="lineCov">         86 :     for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<span class="lineNum">    1186 </span>[<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchCov" title="Branch 1 was taken 14 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 112 times"> + </span><span class="branchCov" title="Branch 3 was taken 56 times"> + </span>]:<span class="lineCov">        210 :       for(Index w=0; w&lt;Pack2; w++)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<span class="lineNum">    1187 </span>[<span class="branchCov" title="Branch 1 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">        140 :         blockA[count++] = cj(lhs(peeled_mc+w, k));</span>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 7 was taken 112 times"> + </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span>][<span class="branchCov" title="Branch 10 was taken 112 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>][<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<span class="lineNum">    1188 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += Pack2 * (stride-offset-depth);</span>
<span class="lineNum">    1189 </span>                :<span class="lineCov">         16 :     peeled_mc += Pack2;</span>
<span class="lineNum">    1190 </span>                :            :   }
<span class="lineNum">    1191 </span>[<span class="branchCov" title="Branch 0 was taken 608 times"> + </span><span class="branchCov" title="Branch 1 was taken 1515 times"> + </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 16 times"> + </span>]:<span class="lineCov">       2139 :   for(Index i=peeled_mc; i&lt;rows; i++)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<span class="lineNum">    1192 </span>                :            :   {
<span class="lineNum">    1193 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += offset;</span>
<span class="lineNum">    1194 </span>[<span class="branchCov" title="Branch 0 was taken 2429 times"> + </span><span class="branchCov" title="Branch 1 was taken 608 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">       3037 :     for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<span class="lineNum">    1195 </span>[<span class="branchCov" title="Branch 1 was taken 2429 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 2429 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       2429 :       blockA[count++] = cj(lhs(i, k));</span>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>][<span class="branchNoExec" title="Branch 10 was not executed"> # </span><span class="branchNoExec" title="Branch 11 was not executed"> # </span>]
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 13 was not executed"> # </span><span class="branchNoExec" title="Branch 14 was not executed"> # </span>][<span class="branchNoExec" title="Branch 16 was not executed"> # </span><span class="branchNoExec" title="Branch 17 was not executed"> # </span>]
<span class="lineNum">    1196 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += (stride-offset-depth);</span>
<span class="lineNum">    1197 </span>                :            :   }
<span class="lineNum">    1198 </span>                :<span class="lineCov">       1531 : }</span>
<span class="lineNum">    1199 </span>                :            : 
<span class="lineNum">    1200 </span>                :            : // copy a complete panel of the rhs
<span class="lineNum">    1201 </span>                :            : // this version is optimized for column major matrices
<span class="lineNum">    1202 </span>                :            : // The traversal order is as follow: (nr==4):
<span class="lineNum">    1203 </span>                :            : //  0  1  2  3   12 13 14 15   24 27
<span class="lineNum">    1204 </span>                :            : //  4  5  6  7   16 17 18 19   25 28
<span class="lineNum">    1205 </span>                :            : //  8  9 10 11   20 21 22 23   26 29
<span class="lineNum">    1206 </span>                :            : //  .  .  .  .    .  .  .  .    .  .
<span class="lineNum">    1207 </span>                :            : template&lt;typename Scalar, typename Index, int nr, bool Conjugate, bool PanelMode&gt;
<span class="lineNum">    1208 </span>                :            : struct gemm_pack_rhs&lt;Scalar, Index, nr, ColMajor, Conjugate, PanelMode&gt;
<span class="lineNum">    1209 </span>                :            : {
<span class="lineNum">    1210 </span>                :            :   typedef typename packet_traits&lt;Scalar&gt;::type Packet;
<span class="lineNum">    1211 </span>                :            :   enum { PacketSize = packet_traits&lt;Scalar&gt;::size };
<span class="lineNum">    1212 </span>                :            :   EIGEN_DONT_INLINE void operator()(Scalar* blockB, const Scalar* rhs, Index rhsStride, Index depth, Index cols, Index stride=0, Index offset=0);
<span class="lineNum">    1213 </span>                :            : };
<a name="1214"><span class="lineNum">    1214 </span>                :            : </a>
<span class="lineNum">    1215 </span>                :            : template&lt;typename Scalar, typename Index, int nr, bool Conjugate, bool PanelMode&gt;
<span class="lineNum">    1216 </span>                :<span class="lineCov">       1895 : EIGEN_DONT_INLINE void gemm_pack_rhs&lt;Scalar, Index, nr, ColMajor, Conjugate, PanelMode&gt;</span>
<span class="lineNum">    1217 </span>                :            :   ::operator()(Scalar* blockB, const Scalar* rhs, Index rhsStride, Index depth, Index cols, Index stride, Index offset)
<span class="lineNum">    1218 </span>                :            : {
<span class="lineNum">    1219 </span>                :<span class="lineCov">       1895 :   EIGEN_ASM_COMMENT(&quot;EIGEN PRODUCT PACK RHS COLMAJOR&quot;);</span>
<span class="lineNum">    1220 </span>  [<span class="branchCov" title="Branch 1 was taken 342 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 4 was taken 1553 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1895 :   EIGEN_UNUSED_VARIABLE(stride)</span>
<span class="lineNum">    1221 </span>[<span class="branchCov" title="Branch 1 was taken 342 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1553 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       1895 :   EIGEN_UNUSED_VARIABLE(offset)</span>
<span class="lineNum">    1222 </span>[<span class="branchCov" title="Branch 0 was taken 342 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 342 times"> + </span>]:<span class="lineCov">       1895 :   eigen_assert(((!PanelMode) &amp;&amp; stride==0 &amp;&amp; offset==0) || (PanelMode &amp;&amp; stride&gt;=depth &amp;&amp; offset&lt;=stride));</span>
<span class="lineNum">         </span>[<span class="branchCov" title="Branch 5 was taken 1553 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span>][<span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1553 times"> + </span>]
<span class="lineNum">    1223 </span>                :            :   conj_if&lt;NumTraits&lt;Scalar&gt;::IsComplex &amp;&amp; Conjugate&gt; cj;
<span class="lineNum">    1224 </span>                :<span class="lineCov">       1895 :   Index packet_cols = (cols/nr) * nr;</span>
<span class="lineNum">    1225 </span>                :<span class="lineCov">       1895 :   Index count = 0;</span>
<span class="lineNum">    1226 </span>[<span class="branchCov" title="Branch 0 was taken 34 times"> + </span><span class="branchCov" title="Branch 1 was taken 340 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1063 times"> + </span><span class="branchCov" title="Branch 3 was taken 1553 times"> + </span>]:<span class="lineCov">       2994 :   for(Index j2=0; j2&lt;packet_cols; j2+=nr)</span>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]
<span class="lineNum">    1227 </span>                :            :   {
<span class="lineNum">    1228 </span>                :            :     // skip what we have before
<span class="lineNum">    1229 </span>                :<span class="lineCov">         34 :     if(PanelMode) count += nr * offset;</span>
<span class="lineNum">    1230 </span>                :<span class="lineCov">       1099 :     const Scalar* b0 = &amp;rhs[(j2+0)*rhsStride];</span>
<span class="lineNum">    1231 </span>                :<span class="lineCov">       1099 :     const Scalar* b1 = &amp;rhs[(j2+1)*rhsStride];</span>
<span class="lineNum">    1232 </span>                :<span class="lineCov">       1099 :     const Scalar* b2 = &amp;rhs[(j2+2)*rhsStride];</span>
<span class="lineNum">    1233 </span>                :<span class="lineCov">       1099 :     const Scalar* b3 = &amp;rhs[(j2+3)*rhsStride];</span>
<span class="lineNum">    1234 </span>[<span class="branchCov" title="Branch 0 was taken 122 times"> + </span><span class="branchCov" title="Branch 1 was taken 36 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 3807 times"> + </span><span class="branchCov" title="Branch 3 was taken 1063 times"> + </span>]:<span class="lineCov">       5028 :     for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]
<span class="lineNum">    1235 </span>                :            :     {
<span class="lineNum">    1236 </span>[<span class="branchCov" title="Branch 1 was taken 122 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3807 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       3929 :                 blockB[count+0] = cj(b0[k]);</span>
<span class="lineNum">    1237 </span>[<span class="branchCov" title="Branch 1 was taken 122 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3807 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       3929 :                 blockB[count+1] = cj(b1[k]);</span>
<span class="lineNum">    1238 </span>[<span class="branchCov" title="Branch 1 was taken 122 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3807 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       3929 :       if(nr==4) blockB[count+2] = cj(b2[k]);</span>
<span class="lineNum">    1239 </span>[<span class="branchCov" title="Branch 1 was taken 122 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 3807 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       3929 :       if(nr==4) blockB[count+3] = cj(b3[k]);</span>
<span class="lineNum">    1240 </span>                :<span class="lineCov">       3929 :       count += nr;</span>
<span class="lineNum">    1241 </span>                :            :     }
<span class="lineNum">    1242 </span>                :            :     // skip what we have after
<span class="lineNum">    1243 </span>                :<span class="lineCov">         34 :     if(PanelMode) count += nr * (stride-offset-depth);</span>
<span class="lineNum">    1244 </span>                :            :   }
<span class="lineNum">    1245 </span>                :            : 
<span class="lineNum">    1246 </span>                :            :   // copy the remaining columns one at a time (nr==1)
<span class="lineNum">    1247 </span>[<span class="branchCov" title="Branch 0 was taken 338 times"> + </span><span class="branchCov" title="Branch 1 was taken 340 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 570 times"> + </span><span class="branchCov" title="Branch 3 was taken 1553 times"> + </span>]:<span class="lineCov">       2807 :   for(Index j2=packet_cols; j2&lt;cols; ++j2)</span>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]
<span class="lineNum">    1248 </span>                :            :   {
<span class="lineNum">    1249 </span>                :<span class="lineCov">        446 :     if(PanelMode) count += offset;</span>
<span class="lineNum">    1250 </span>                :<span class="lineCov">        912 :     const Scalar* b0 = &amp;rhs[(j2+0)*rhsStride];</span>
<span class="lineNum">    1251 </span>[<span class="branchCov" title="Branch 0 was taken 412 times"> + </span><span class="branchCov" title="Branch 1 was taken 342 times"> + </span>][<span class="branchCov" title="Branch 2 was taken 1416 times"> + </span><span class="branchCov" title="Branch 3 was taken 462 times"> + </span>]:<span class="lineCov">       3064 :     for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">         </span>        [<span class="branchCov" title="Branch 2 was taken 324 times"> + </span><span class="branchCov" title="Branch 3 was taken 108 times"> + </span>]
<span class="lineNum">    1252 </span>                :            :     {
<span class="lineNum">    1253 </span>[<span class="branchCov" title="Branch 1 was taken 412 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchCov" title="Branch 4 was taken 1740 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]:<span class="lineCov">       2152 :       blockB[count] = cj(b0[k]);</span>
<span class="lineNum">    1254 </span>                :<span class="lineCov">       2152 :       count += 1;</span>
<span class="lineNum">    1255 </span>                :            :     }
<span class="lineNum">    1256 </span>                :<span class="lineCov">        446 :     if(PanelMode) count += (stride-offset-depth);</span>
<span class="lineNum">    1257 </span>                :            :   }
<span class="lineNum">    1258 </span>                :<span class="lineCov">       1895 : }</span>
<span class="lineNum">    1259 </span>                :            : 
<span class="lineNum">    1260 </span>                :            : // this version is optimized for row major matrices
<span class="lineNum">    1261 </span>                :            : template&lt;typename Scalar, typename Index, int nr, bool Conjugate, bool PanelMode&gt;
<span class="lineNum">    1262 </span>                :            : struct gemm_pack_rhs&lt;Scalar, Index, nr, RowMajor, Conjugate, PanelMode&gt;
<span class="lineNum">    1263 </span>                :            : {
<span class="lineNum">    1264 </span>                :            :   enum { PacketSize = packet_traits&lt;Scalar&gt;::size };
<span class="lineNum">    1265 </span>                :            :   EIGEN_DONT_INLINE void operator()(Scalar* blockB, const Scalar* rhs, Index rhsStride, Index depth, Index cols, Index stride=0, Index offset=0);
<span class="lineNum">    1266 </span>                :            : };
<a name="1267"><span class="lineNum">    1267 </span>                :            : </a>
<span class="lineNum">    1268 </span>                :            : template&lt;typename Scalar, typename Index, int nr, bool Conjugate, bool PanelMode&gt;
<span class="lineNum">    1269 </span>                :<span class="lineCov">          2 : EIGEN_DONT_INLINE void gemm_pack_rhs&lt;Scalar, Index, nr, RowMajor, Conjugate, PanelMode&gt;</span>
<span class="lineNum">    1270 </span>                :            :   ::operator()(Scalar* blockB, const Scalar* rhs, Index rhsStride, Index depth, Index cols, Index stride, Index offset)
<span class="lineNum">    1271 </span>                :            : {
<span class="lineNum">    1272 </span>                :<span class="lineCov">          2 :   EIGEN_ASM_COMMENT(&quot;EIGEN PRODUCT PACK RHS ROWMAJOR&quot;);</span>
<span class="lineNum">    1273 </span>  [<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">          2 :   EIGEN_UNUSED_VARIABLE(stride)</span>
<span class="lineNum">    1274 </span>[<span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">          2 :   EIGEN_UNUSED_VARIABLE(offset)</span>
<span class="lineNum">    1275 </span>[<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>][<span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">          2 :   eigen_assert(((!PanelMode) &amp;&amp; stride==0 &amp;&amp; offset==0) || (PanelMode &amp;&amp; stride&gt;=depth &amp;&amp; offset&lt;=stride));</span>
<span class="lineNum">         </span>[<span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span>][<span class="branchNoExec" title="Branch 7 was not executed"> # </span><span class="branchNoExec" title="Branch 8 was not executed"> # </span>]
<span class="lineNum">    1276 </span>                :            :   conj_if&lt;NumTraits&lt;Scalar&gt;::IsComplex &amp;&amp; Conjugate&gt; cj;
<span class="lineNum">    1277 </span>                :<span class="lineCov">          2 :   Index packet_cols = (cols/nr) * nr;</span>
<span class="lineNum">    1278 </span>                :<span class="lineCov">          2 :   Index count = 0;</span>
<span class="lineNum">    1279 </span>[<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>][<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineCov">          4 :   for(Index j2=0; j2&lt;packet_cols; j2+=nr)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]
<span class="lineNum">    1280 </span>                :            :   {
<span class="lineNum">    1281 </span>                :            :     // skip what we have before
<span class="lineNum">    1282 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += nr * offset;</span>
<span class="lineNum">    1283 </span>[<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">         12 :     for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">    1284 </span>                :            :     {
<span class="lineNum">    1285 </span>                :<span class="lineCov">         10 :       const Scalar* b0 = &amp;rhs[k*rhsStride + j2];</span>
<span class="lineNum">    1286 </span>[<span class="branchCov" title="Branch 1 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         10 :                 blockB[count+0] = cj(b0[0]);</span>
<span class="lineNum">    1287 </span>[<span class="branchCov" title="Branch 1 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         10 :                 blockB[count+1] = cj(b0[1]);</span>
<span class="lineNum">    1288 </span>[<span class="branchCov" title="Branch 1 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         10 :       if(nr==4) blockB[count+2] = cj(b0[2]);</span>
<span class="lineNum">    1289 </span>[<span class="branchCov" title="Branch 1 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         10 :       if(nr==4) blockB[count+3] = cj(b0[3]);</span>
<span class="lineNum">    1290 </span>                :<span class="lineCov">         10 :       count += nr;</span>
<span class="lineNum">    1291 </span>                :            :     }
<span class="lineNum">    1292 </span>                :            :     // skip what we have after
<span class="lineNum">    1293 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += nr * (stride-offset-depth);</span>
<span class="lineNum">    1294 </span>                :            :   }
<span class="lineNum">    1295 </span>                :            :   // copy the remaining columns one at a time (nr==1)
<span class="lineNum">    1296 </span>[<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>][<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineCov">          4 :   for(Index j2=packet_cols; j2&lt;cols; ++j2)</span>
<span class="lineNum">         </span>        [<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]
<span class="lineNum">    1297 </span>                :            :   {
<span class="lineNum">    1298 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += offset;</span>
<span class="lineNum">    1299 </span>                :<span class="lineCov">          2 :     const Scalar* b0 = &amp;rhs[j2];</span>
<span class="lineNum">    1300 </span>[<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>][<span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineCov">         14 :     for(Index k=0; k&lt;depth; k++)</span>
<span class="lineNum">    1301 </span>                :            :     {
<span class="lineNum">    1302 </span>[<span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>][<span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]:<span class="lineCov">         12 :       blockB[count] = cj(b0[k*rhsStride]);</span>
<span class="lineNum">    1303 </span>                :<span class="lineCov">         12 :       count += 1;</span>
<span class="lineNum">    1304 </span>                :            :     }
<span class="lineNum">    1305 </span>                :<span class="lineNoCov">          0 :     if(PanelMode) count += stride-offset-depth;</span>
<span class="lineNum">    1306 </span>                :            :   }
<span class="lineNum">    1307 </span>                :<span class="lineCov">          2 : }</span>
<span class="lineNum">    1308 </span>                :            : 
<span class="lineNum">    1309 </span>                :            : } // end namespace internal
<span class="lineNum">    1310 </span>                :            : 
<span class="lineNum">    1311 </span>                :            : /** \returns the currently set level 1 cpu cache size (in bytes) used to estimate the ideal blocking size parameters.
<span class="lineNum">    1312 </span>                :            :   * \sa setCpuCacheSize */
<span class="lineNum">    1313 </span>                :            : inline std::ptrdiff_t l1CacheSize()
<span class="lineNum">    1314 </span>                :            : {
<span class="lineNum">    1315 </span>                :            :   std::ptrdiff_t l1, l2;
<span class="lineNum">    1316 </span>                :            :   internal::manage_caching_sizes(GetAction, &amp;l1, &amp;l2);
<span class="lineNum">    1317 </span>                :            :   return l1;
<span class="lineNum">    1318 </span>                :            : }
<span class="lineNum">    1319 </span>                :            : 
<span class="lineNum">    1320 </span>                :            : /** \returns the currently set level 2 cpu cache size (in bytes) used to estimate the ideal blocking size parameters.
<span class="lineNum">    1321 </span>                :            :   * \sa setCpuCacheSize */
<span class="lineNum">    1322 </span>                :            : inline std::ptrdiff_t l2CacheSize()
<span class="lineNum">    1323 </span>                :            : {
<span class="lineNum">    1324 </span>                :            :   std::ptrdiff_t l1, l2;
<span class="lineNum">    1325 </span>                :            :   internal::manage_caching_sizes(GetAction, &amp;l1, &amp;l2);
<span class="lineNum">    1326 </span>                :            :   return l2;
<span class="lineNum">    1327 </span>                :            : }
<span class="lineNum">    1328 </span>                :            : 
<span class="lineNum">    1329 </span>                :            : /** Set the cpu L1 and L2 cache sizes (in bytes).
<span class="lineNum">    1330 </span>                :            :   * These values are use to adjust the size of the blocks
<span class="lineNum">    1331 </span>                :            :   * for the algorithms working per blocks.
<span class="lineNum">    1332 </span>                :            :   *
<span class="lineNum">    1333 </span>                :            :   * \sa computeProductBlockingSizes */
<span class="lineNum">    1334 </span>                :            : inline void setCpuCacheSizes(std::ptrdiff_t l1, std::ptrdiff_t l2)
<span class="lineNum">    1335 </span>                :            : {
<span class="lineNum">    1336 </span>                :            :   internal::manage_caching_sizes(SetAction, &amp;l1, &amp;l2);
<span class="lineNum">    1337 </span>                :            : }
<span class="lineNum">    1338 </span>                :            : 
<span class="lineNum">    1339 </span>                :            : } // end namespace Eigen
<span class="lineNum">    1340 </span>                :            : 
<span class="lineNum">    1341 </span>                :            : #endif // EIGEN_GENERAL_BLOCK_PANEL_H
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.13</a></td></tr>
  </table>
  <br>

</body>
</html>
